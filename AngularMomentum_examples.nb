(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    149467,       4246]
NotebookOptionsPosition[    143427,       4056]
NotebookOutlinePosition[    143783,       4072]
CellTagsIndexPosition[    143740,       4069]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Basic Usage", "Section",
 CellChangeTimes->{{3.606123433686789*^9, 3.606123438823172*^9}}],

Cell["First of all, the AngularMomentum Package must be loaded:", "Text",
 CellChangeTimes->{{3.60611007968565*^9, 3.606110115669086*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Path", "=", 
   RowBox[{"DeleteDuplicates", "@", 
    RowBox[{"Append", "[", 
     RowBox[{"$Path", ",", 
      RowBox[{"NotebookDirectory", "[", "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "AngularMomentum`"}]}], "Input",
 CellChangeTimes->{{3.606110092104203*^9, 3.606110097064487*^9}, {
  3.606110326552638*^9, 3.60611037716278*^9}}],

Cell["\<\
Loading the package might take some time (~15 s on my machine). There is one \
known issue when loading it multiple times: In this case loading the package \
may never finish. In this case abort the evaluation (Evaluation->Abort \
Evaluation / Alt+.) and try again.\
\>", "Text",
 CellChangeTimes->{{3.606110122341791*^9, 3.606110251798451*^9}}],

Cell["\<\
Lets assume we want to simplify the following expression, which invovles a \
few Clebsch-\[LineSeparator]Gordan symbols:\
\>", "Text",
 CellChangeTimes->{{3.606110029526826*^9, 3.6061100725535307`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"testExpr", "[", "1", "]"}], "=", 
   RowBox[{"sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"cg", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", "2"}], ",", 
          RowBox[{"mt", "[", "a", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", "2"}], ",", 
          RowBox[{"mt", "[", "b", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"t", "[", 
           RowBox[{"a", ",", "b"}], "]"}], ",", 
          RowBox[{"mt", "[", 
           RowBox[{"a", ",", "b"}], "]"}]}], "}"}]}], "]"}], " ", 
      RowBox[{"cg", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", "2"}], ",", 
          RowBox[{"mtp", "[", "a", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", "2"}], ",", 
          RowBox[{"mtp", "[", "b", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"tp", "[", 
           RowBox[{"a", ",", "b"}], "]"}], ",", 
          RowBox[{"mtp", "[", 
           RowBox[{"a", ",", "b"}], "]"}]}], "}"}]}], "]"}], " ", 
      RowBox[{"cg", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"t", "[", 
           RowBox[{"a", ",", "b"}], "]"}], ",", 
          RowBox[{"mt", "[", 
           RowBox[{"a", ",", "b"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", "2"}], ",", 
          RowBox[{"mt", "[", "c", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"t", "[", 
           RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", 
          RowBox[{"mt", "[", 
           RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], "}"}]}], "]"}], " ", 
      RowBox[{"cg", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"tp", "[", 
           RowBox[{"a", ",", "b"}], "]"}], ",", 
          RowBox[{"mtp", "[", 
           RowBox[{"a", ",", "b"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", "2"}], ",", 
          RowBox[{"mtp", "[", "c", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"tp", "[", 
           RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", 
          RowBox[{"mtp", "[", 
           RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], "}"}]}], "]"}], " ", 
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{
        RowBox[{"mt", "[", "c", "]"}], ",", 
        RowBox[{"mtp", "[", "c", "]"}]}], "]"}], " ", 
      RowBox[{"sum", "[", 
       RowBox[{
        RowBox[{"3", " ", 
         RowBox[{"cg", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{"mt", "[", "b", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "\[Mu]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{"mtp", "[", "b", "]"}]}], "}"}]}], "]"}], " ", 
         RowBox[{"cg", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{"mtp", "[", "a", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "\[Mu]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{"mt", "[", "a", "]"}]}], "}"}]}], "]"}]}], ",", 
        "\[Mu]"}], "]"}]}], ",", 
     RowBox[{"mt", "[", "a", "]"}], ",", 
     RowBox[{"mt", "[", "b", "]"}], ",", 
     RowBox[{"mt", "[", "c", "]"}], ",", 
     RowBox[{"mt", "[", 
      RowBox[{"a", ",", "b"}], "]"}], ",", 
     RowBox[{"mtp", "[", "a", "]"}], ",", 
     RowBox[{"mtp", "[", "b", "]"}], ",", 
     RowBox[{"mtp", "[", "c", "]"}], ",", 
     RowBox[{"mtp", "[", 
      RowBox[{"a", ",", "b"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.606110014808257*^9}],

Cell["\<\
As this looks rather ugly, lets have a look at the expression in the \
traditional form:\
\>", "Text",
 CellChangeTimes->{{3.606110264933941*^9, 3.60611027062984*^9}, {
  3.606110401830777*^9, 3.606110439013682*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"testExpr", "[", "1", "]"}], "//", "TraditionalForm"}]], "Input",
 CellChangeTimes->{{3.606110440431953*^9, 3.60611044535828*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   UnderscriptBox["\[Sum]", 
    RowBox[{"mt", "(", "a", ")"}]], 
   RowBox[{
    UnderscriptBox["\[Sum]", 
     RowBox[{"mt", "(", "b", ")"}]], 
    RowBox[{
     UnderscriptBox["\[Sum]", 
      RowBox[{"mt", "(", "c", ")"}]], 
     RowBox[{
      UnderscriptBox["\[Sum]", 
       RowBox[{"mt", "(", 
        RowBox[{"a", ",", "b"}], ")"}]], 
      RowBox[{
       UnderscriptBox["\[Sum]", 
        RowBox[{"mtp", "(", "a", ")"}]], 
       RowBox[{
        UnderscriptBox["\[Sum]", 
         RowBox[{"mtp", "(", "b", ")"}]], 
        RowBox[{
         UnderscriptBox["\[Sum]", 
          RowBox[{"mtp", "(", "c", ")"}]], 
         RowBox[{
          UnderscriptBox["\[Sum]", 
           RowBox[{"mtp", "(", 
            RowBox[{"a", ",", "b"}], ")"}]], 
          RowBox[{
           TemplateBox[{RowBox[{
               RowBox[{"mt", "(", "c", ")"}], ",", 
               RowBox[{"mtp", "(", "c", ")"}]}]},
            "KroneckerDeltaSeq"], " ", 
           StyleBox[
            RowBox[{"c", "(", GridBox[{
               {
                FractionBox["1", "2"], 
                FractionBox["1", "2"]},
               {
                RowBox[{"mt", "(", "a", ")"}], 
                RowBox[{"mt", "(", "b", ")"}]}
              }], "|", GridBox[{
               {
                RowBox[{"t", "(", 
                 RowBox[{"a", ",", "b"}], ")"}]},
               {
                RowBox[{"mt", "(", 
                 RowBox[{"a", ",", "b"}], ")"}]}
              }], ")"}],
            SpanMaxSize->DirectedInfinity[1]], " ", 
           StyleBox[
            RowBox[{"c", "(", GridBox[{
               {
                RowBox[{"t", "(", 
                 RowBox[{"a", ",", "b"}], ")"}], 
                FractionBox["1", "2"]},
               {
                RowBox[{"mt", "(", 
                 RowBox[{"a", ",", "b"}], ")"}], 
                RowBox[{"mt", "(", "c", ")"}]}
              }], "|", GridBox[{
               {
                RowBox[{"t", "(", 
                 RowBox[{"a", ",", "b", ",", "c"}], ")"}]},
               {
                RowBox[{"mt", "(", 
                 RowBox[{"a", ",", "b", ",", "c"}], ")"}]}
              }], ")"}],
            SpanMaxSize->DirectedInfinity[1]], " ", 
           StyleBox[
            RowBox[{"c", "(", GridBox[{
               {
                FractionBox["1", "2"], 
                FractionBox["1", "2"]},
               {
                RowBox[{"mtp", "(", "a", ")"}], 
                RowBox[{"mtp", "(", "b", ")"}]}
              }], "|", GridBox[{
               {
                RowBox[{"tp", "(", 
                 RowBox[{"a", ",", "b"}], ")"}]},
               {
                RowBox[{"mtp", "(", 
                 RowBox[{"a", ",", "b"}], ")"}]}
              }], ")"}],
            SpanMaxSize->DirectedInfinity[1]], " ", 
           StyleBox[
            RowBox[{"c", "(", GridBox[{
               {
                RowBox[{"tp", "(", 
                 RowBox[{"a", ",", "b"}], ")"}], 
                FractionBox["1", "2"]},
               {
                RowBox[{"mtp", "(", 
                 RowBox[{"a", ",", "b"}], ")"}], 
                RowBox[{"mtp", "(", "c", ")"}]}
              }], "|", GridBox[{
               {
                RowBox[{"tp", "(", 
                 RowBox[{"a", ",", "b", ",", "c"}], ")"}]},
               {
                RowBox[{"mtp", "(", 
                 RowBox[{"a", ",", "b", ",", "c"}], ")"}]}
              }], ")"}],
            SpanMaxSize->DirectedInfinity[1]], " ", 
           RowBox[{
            UnderscriptBox["\[Sum]", "\[Mu]"], 
            RowBox[{"3", " ", 
             StyleBox[
              RowBox[{"c", "(", GridBox[{
                 {
                  FractionBox["1", "2"], "1"},
                 {
                  RowBox[{"mtp", "(", "a", ")"}], "\[Mu]"}
                }], "|", GridBox[{
                 {
                  FractionBox["1", "2"]},
                 {
                  RowBox[{"mt", "(", "a", ")"}]}
                }], ")"}],
              SpanMaxSize->DirectedInfinity[1]], " ", 
             StyleBox[
              RowBox[{"c", "(", GridBox[{
                 {
                  FractionBox["1", "2"], "1"},
                 {
                  RowBox[{"mt", "(", "b", ")"}], "\[Mu]"}
                }], "|", GridBox[{
                 {
                  FractionBox["1", "2"]},
                 {
                  RowBox[{"mtp", "(", "b", ")"}]}
                }], ")"}],
              SpanMaxSize->DirectedInfinity[1]]}]}]}]}]}]}]}]}]}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.6061104500673637`*^9, 3.606125325130004*^9, 
  3.606125369190948*^9, 3.606203533464745*^9, 3.60621119481712*^9}]
}, Open  ]],

Cell[TextData[{
 "This is still rather ugly. We need to tell ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " how to represent the quantum numbers.\nIn this case this is rather easy:"
}], "Text",
 CellChangeTimes->{{3.606110264933941*^9, 3.60611027062984*^9}, {
  3.606110401830777*^9, 3.606110516486414*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"declareIndexedAM", "[", "t", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.606110517965289*^9, 3.606110536617663*^9}}],

Cell["\<\
There are multiple declare functions in the Utility` package, you can have a \
look at them by typing\
\>", "Text",
 CellChangeTimes->{{3.60611060840596*^9, 3.606110651461768*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "Utility`declare*"}]], "Input",
 CellChangeTimes->{{3.606110652825758*^9, 3.606110659353221*^9}}],

Cell[BoxData[
 DynamicModuleBox[{Typeset`open$$ = True}, 
  PaneSelectorBox[{False->
   RowBox[{
    OpenerBox[Dynamic[Typeset`open$$],
     ImageSize->Small], 
    StyleBox["Utility`", "InfoHeading"]}], True->GridBox[{
     {
      RowBox[{
       OpenerBox[Dynamic[Typeset`open$$],
        ImageSize->Small], 
       StyleBox["Utility`", "InfoHeading"]}]},
     {GridBox[{
        {
         ButtonBox["declareIndexed",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info3606210736-7505383", {"declareIndexed", "Utility`"}},
          ButtonNote->"Utility`"], 
         ButtonBox["declareIndexedPrimed",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info3606210736-7505383", {"declareIndexedPrimed", "Utility`"}},
          ButtonNote->"Utility`"]},
        {
         ButtonBox["declareIndexedAM",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info3606210736-7505383", {"declareIndexedAM", "Utility`"}},
          ButtonNote->"Utility`"], 
         ButtonBox["declarePrimed",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info3606210736-7505383", {"declarePrimed", "Utility`"}},
          ButtonNote->"Utility`"]}
       },
       DefaultBaseStyle->"InfoGrid",
       GridBoxItemSize->{"Columns" -> {{
            Scaled[0.475]}}}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}}]}, 
   Dynamic[Typeset`open$$],
   ImageSize->Automatic]]], "Print", "InfoCell",
 CellChangeTimes->{3.6062035368593493`*^9}]
}, Open  ]],

Cell["Back to our expression:", "Text",
 CellChangeTimes->{{3.6061106831266327`*^9, 3.606110686997703*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"testExpr", "[", "1", "]"}], "//", "TraditionalForm"}]], "Input",
 CellChangeTimes->{{3.606110694425643*^9, 3.606110695753961*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   UnderscriptBox["\[Sum]", 
    SubscriptBox["m", 
     SubscriptBox["t", "a"]]], 
   RowBox[{
    UnderscriptBox["\[Sum]", 
     SubscriptBox["m", 
      SubscriptBox["t", "b"]]], 
    RowBox[{
     UnderscriptBox["\[Sum]", 
      SubscriptBox["m", 
       SubscriptBox["t", "c"]]], 
     RowBox[{
      UnderscriptBox["\[Sum]", 
       SubscriptBox["m", 
        SubscriptBox["t", 
         RowBox[{"a", "\[InvisibleComma]", "b"}]]]], 
      RowBox[{
       UnderscriptBox["\[Sum]", 
        SubsuperscriptBox["m", 
         SubscriptBox["t", "a"], "\[Prime]"]], 
       RowBox[{
        UnderscriptBox["\[Sum]", 
         SubsuperscriptBox["m", 
          SubscriptBox["t", "b"], "\[Prime]"]], 
        RowBox[{
         UnderscriptBox["\[Sum]", 
          SubsuperscriptBox["m", 
           SubscriptBox["t", "c"], "\[Prime]"]], 
         RowBox[{
          UnderscriptBox["\[Sum]", 
           SubsuperscriptBox["m", 
            SubscriptBox["t", 
             RowBox[{"a", "\[InvisibleComma]", "b"}]], "\[Prime]"]], 
          RowBox[{
           TemplateBox[{RowBox[{
               SubscriptBox["m", 
                SubscriptBox["t", "c"]], ",", 
               SubsuperscriptBox["m", 
                SubscriptBox["t", "c"], "\[Prime]"]}]},
            "KroneckerDeltaSeq"], " ", 
           StyleBox[
            RowBox[{"c", "(", GridBox[{
               {
                FractionBox["1", "2"], 
                FractionBox["1", "2"]},
               {
                SubscriptBox["m", 
                 SubscriptBox["t", "a"]], 
                SubscriptBox["m", 
                 SubscriptBox["t", "b"]]}
              }], "|", GridBox[{
               {
                SubscriptBox["t", 
                 RowBox[{"a", "\[InvisibleComma]", "b"}]]},
               {
                SubscriptBox["m", 
                 SubscriptBox["t", 
                  RowBox[{"a", "\[InvisibleComma]", "b"}]]]}
              }], ")"}],
            SpanMaxSize->DirectedInfinity[1]], " ", 
           StyleBox[
            RowBox[{"c", "(", GridBox[{
               {
                SubscriptBox["t", 
                 RowBox[{"a", "\[InvisibleComma]", "b"}]], 
                FractionBox["1", "2"]},
               {
                SubscriptBox["m", 
                 SubscriptBox["t", 
                  RowBox[{"a", "\[InvisibleComma]", "b"}]]], 
                SubscriptBox["m", 
                 SubscriptBox["t", "c"]]}
              }], "|", GridBox[{
               {
                SubscriptBox["t", 
                 RowBox[{
                 "a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}]]},
               {
                SubscriptBox["m", 
                 SubscriptBox["t", 
                  RowBox[{
                  "a", "\[InvisibleComma]", "b", "\[InvisibleComma]", 
                   "c"}]]]}
              }], ")"}],
            SpanMaxSize->DirectedInfinity[1]], " ", 
           StyleBox[
            RowBox[{"c", "(", GridBox[{
               {
                FractionBox["1", "2"], 
                FractionBox["1", "2"]},
               {
                SubsuperscriptBox["m", 
                 SubscriptBox["t", "a"], "\[Prime]"], 
                SubsuperscriptBox["m", 
                 SubscriptBox["t", "b"], "\[Prime]"]}
              }], "|", GridBox[{
               {
                SubsuperscriptBox["t", 
                 RowBox[{"a", "\[InvisibleComma]", "b"}], "\[Prime]"]},
               {
                SubsuperscriptBox["m", 
                 SubscriptBox["t", 
                  RowBox[{"a", "\[InvisibleComma]", "b"}]], "\[Prime]"]}
              }], ")"}],
            SpanMaxSize->DirectedInfinity[1]], " ", 
           StyleBox[
            RowBox[{"c", "(", GridBox[{
               {
                SubsuperscriptBox["t", 
                 RowBox[{"a", "\[InvisibleComma]", "b"}], "\[Prime]"], 
                FractionBox["1", "2"]},
               {
                SubsuperscriptBox["m", 
                 SubscriptBox["t", 
                  RowBox[{"a", "\[InvisibleComma]", "b"}]], "\[Prime]"], 
                SubsuperscriptBox["m", 
                 SubscriptBox["t", "c"], "\[Prime]"]}
              }], "|", GridBox[{
               {
                SubsuperscriptBox["t", 
                 RowBox[{
                 "a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}], 
                 "\[Prime]"]},
               {
                SubsuperscriptBox["m", 
                 SubscriptBox["t", 
                  RowBox[{
                  "a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}]], 
                 "\[Prime]"]}
              }], ")"}],
            SpanMaxSize->DirectedInfinity[1]], " ", 
           RowBox[{
            UnderscriptBox["\[Sum]", "\[Mu]"], 
            RowBox[{"3", " ", 
             StyleBox[
              RowBox[{"c", "(", GridBox[{
                 {
                  FractionBox["1", "2"], "1"},
                 {
                  SubsuperscriptBox["m", 
                   SubscriptBox["t", "a"], "\[Prime]"], "\[Mu]"}
                }], "|", GridBox[{
                 {
                  FractionBox["1", "2"]},
                 {
                  SubscriptBox["m", 
                   SubscriptBox["t", "a"]]}
                }], ")"}],
              SpanMaxSize->DirectedInfinity[1]], " ", 
             StyleBox[
              RowBox[{"c", "(", GridBox[{
                 {
                  FractionBox["1", "2"], "1"},
                 {
                  SubscriptBox["m", 
                   SubscriptBox["t", "b"]], "\[Mu]"}
                }], "|", GridBox[{
                 {
                  FractionBox["1", "2"]},
                 {
                  SubsuperscriptBox["m", 
                   SubscriptBox["t", "b"], "\[Prime]"]}
                }], ")"}],
              SpanMaxSize->DirectedInfinity[1]]}]}]}]}]}]}]}]}]}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.606110697788073*^9, 3.606125376729475*^9, 3.606203539796225*^9, {
   3.6062112038401623`*^9, 3.60621122044797*^9}}]
}, Open  ]],

Cell["\<\
It looks better now. The next step is to check whether our expression does \
make any sense (actually this is done automatically when trying to perform a \
simplification, however we will do it explicitly here and discuss possible \
problems).\
\>", "Text",
 CellChangeTimes->{{3.6061106831266327`*^9, 3.606110745238072*^9}, {
   3.60611125060001*^9, 3.606111299510662*^9}, {3.6061194109321327`*^9, 
   3.606119428004662*^9}, 3.606119510147793*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"testExpr", "[", "1", "]"}], "//", "consistencyCheck"}]], "Input",
 CellChangeTimes->{{3.606111302116479*^9, 3.606111314304575*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"consistencyCheck", "::", "notfound"}], "MessageName"], ":", 
  " ", "\<\"Symbol \\\"\[NoBreak]\\!\\(t[\\(\\(a, b\\)\\)]\\)\[NoBreak]\\\" \
has not been declared an integer or half-integer quantum number. Please use \
the functions declareQNInteger and declareQNHalfInteger. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/notfound\\\", \
ButtonNote -> \\\"AngularMomentum`consistencyCheck::notfound\\\"]\\)\"\>"}]], \
"Message", "MSG",
 CellChangeTimes->{3.606111315405006*^9, 3.60612537914675*^9, 
  3.606211232477311*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"consistencyCheck", "::", "notfound"}], "MessageName"], ":", 
  " ", "\<\"Symbol \\\"\[NoBreak]\\!\\(mt[a]\\)\[NoBreak]\\\" has not been \
declared an integer or half-integer quantum number. Please use the functions \
declareQNInteger and declareQNHalfInteger. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/notfound\\\", ButtonNote -> \
\\\"AngularMomentum`consistencyCheck::notfound\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{3.606111315405006*^9, 3.60612537914675*^9, 
  3.6062112325370827`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"consistencyCheck", "::", "notfound"}], "MessageName"], ":", 
  " ", "\<\"Symbol \\\"\[NoBreak]\\!\\(mt[b]\\)\[NoBreak]\\\" has not been \
declared an integer or half-integer quantum number. Please use the functions \
declareQNInteger and declareQNHalfInteger. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/notfound\\\", ButtonNote -> \
\\\"AngularMomentum`consistencyCheck::notfound\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{3.606111315405006*^9, 3.60612537914675*^9, 
  3.606211232597752*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], ":", 
  " ", "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(consistencyCheck \
:: notfound\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during \
this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.606111315405006*^9, 3.60612537914675*^9, 
  3.6062112326432667`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"consistencyCheck", "::", "halfinteger"}], "MessageName"], ":", 
  " ", "\<\"Condition \
\\\"\[NoBreak]\\!\\(\\*TagBox[\\(TraditionalForm\\`\\*StyleBox[\\(\
\[EmptyUpTriangle] {1\\/2 1\\/2 t\\_\\(a \[InvisibleComma] b\\)}\\), \
Rule[SpanMaxSize, DirectedInfinity[1]]]\\), TraditionalForm, Rule[Editable, \
True]]\\)\[NoBreak]\\\" cannot be fulfilled as the sum of the arguments \
cannot yield an integer\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.606111315405006*^9, 3.60612537914675*^9, 
  3.60621123273484*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"consistencyCheck", "::", "halfinteger"}], "MessageName"], ":", 
  " ", "\<\"Condition \
\\\"\[NoBreak]\\!\\(\\*TagBox[\\(TraditionalForm\\`\\*TemplateBox[List[RowBox[\
List[RowBox[List[RowBox[List[\\\"-\\\", SubscriptBox[\\\"m\\\", SubscriptBox[\
\\\"t\\\", RowBox[List[\\\"a\\\", \\\"\\\\[InvisibleComma]\\\", \
\\\"b\\\"]]]]]], \\\"+\\\", SubscriptBox[\\\"m\\\", SubscriptBox[\\\"t\\\", \
RowBox[List[\\\"a\\\"]]]], \\\"+\\\", SubscriptBox[\\\"m\\\", SubscriptBox[\\\
\"t\\\", RowBox[List[\\\"b\\\"]]]]]], \\\",\\\", \\\"0\\\"]]], \
\\\"KroneckerDeltaSeq\\\"]\\), TraditionalForm, Rule[Editable, True]]\\)\
\[NoBreak]\\\" cannot be fulfilled as the sum of the arguments cannot yield \
an integer\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.606111315405006*^9, 3.60612537914675*^9, 
  3.606211232853093*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"consistencyCheck", "::", "halfinteger"}], "MessageName"], ":", 
  " ", "\<\"Condition \
\\\"\[NoBreak]\\!\\(\\*TagBox[\\(TraditionalForm\\`\\*StyleBox[\\(\
\[EmptyUpTriangle] {1\\/2 1\\/2 t\\_\\(a \[InvisibleComma] \
b\\)\\%\[Prime]}\\), Rule[SpanMaxSize, DirectedInfinity[1]]]\\), \
TraditionalForm, Rule[Editable, True]]\\)\[NoBreak]\\\" cannot be fulfilled \
as the sum of the arguments cannot yield an integer\"\>"}]], "Message", "MSG",
 
 CellChangeTimes->{3.606111315405006*^9, 3.60612537914675*^9, 
  3.606211232963801*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], ":", 
  " ", "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(consistencyCheck \
:: halfinteger\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed \
during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.606111315405006*^9, 3.60612537914675*^9, 
  3.606211233013879*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"consistencyCheck", "::", "projection"}], "MessageName"], ":", 
  " ", "\<\"Symbols \
\\\"\[NoBreak]\\!\\(\\*TagBox[\\(TraditionalForm\\`1\\/2\\), TraditionalForm, \
Rule[Editable, True]]\\)\[NoBreak]\\\" and \
\\\"\[NoBreak]\\!\\(\\*TagBox[\\(TraditionalForm\\`m\\_\\(t\\_\\(a\\)\\)\\), \
TraditionalForm, Rule[Editable, True]]\\)\[NoBreak]\\\" have not been \
declared consistently, e.g. one might be an integer and the other is a \
half-integer\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.606111315405006*^9, 3.60612537914675*^9, 
  3.606211233101798*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"consistencyCheck", "::", "projection"}], "MessageName"], ":", 
  " ", "\<\"Symbols \
\\\"\[NoBreak]\\!\\(\\*TagBox[\\(TraditionalForm\\`1\\/2\\), TraditionalForm, \
Rule[Editable, True]]\\)\[NoBreak]\\\" and \
\\\"\[NoBreak]\\!\\(\\*TagBox[\\(TraditionalForm\\`m\\_\\(t\\_\\(b\\)\\)\\), \
TraditionalForm, Rule[Editable, True]]\\)\[NoBreak]\\\" have not been \
declared consistently, e.g. one might be an integer and the other is a \
half-integer\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.606111315405006*^9, 3.60612537914675*^9, 
  3.6062112332143993`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"consistencyCheck", "::", "projection"}], "MessageName"], ":", 
  " ", "\<\"Symbols \
\\\"\[NoBreak]\\!\\(\\*TagBox[\\(TraditionalForm\\`t\\_\\(a \[InvisibleComma] \
b\\)\\), TraditionalForm, Rule[Editable, True]]\\)\[NoBreak]\\\" and \\\"\
\[NoBreak]\\!\\(\\*TagBox[\\(TraditionalForm\\`m\\_\\(t\\_\\(a \
\[InvisibleComma] b\\)\\)\\), TraditionalForm, Rule[Editable, True]]\\)\
\[NoBreak]\\\" have not been declared consistently, e.g. one might be an \
integer and the other is a half-integer\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.606111315405006*^9, 3.60612537914675*^9, 
  3.6062112333303747`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], ":", 
  " ", "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(consistencyCheck \
:: projection\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during \
this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.606111315405006*^9, 3.60612537914675*^9, 
  3.606211233382408*^9}]
}, Open  ]],

Cell[TextData[{
 "There are multiple errors. All of the relate to a simple problem: We have \
not told ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " about the quantum numbers we are using. These are the first error \
messages, consistencyCheck::notfound. The other errors just pop up because ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " has no idea about the symbols. It wants to know whether the quantum \
numbers are integers or half-integers. We provide this information now:"
}], "Text",
 CellChangeTimes->{{3.606111336295247*^9, 3.606111474663344*^9}, {
   3.606119450917115*^9, 3.606119455460417*^9}, 3.60611949366859*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"declareQNHalfInteger", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"mt", "[", "a", "]"}], ",", 
     RowBox[{"mt", "[", "b", "]"}], ",", 
     RowBox[{"mt", "[", "c", "]"}], ",", 
     RowBox[{"mtp", "[", "a", "]"}], ",", 
     RowBox[{"mtp", "[", "b", "]"}], ",", 
     RowBox[{"mtp", "[", "c", "]"}], ",", 
     RowBox[{"t", "[", 
      RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", 
     RowBox[{"tp", "[", 
      RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", 
     RowBox[{"mt", "[", 
      RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", 
     RowBox[{"mtp", "[", 
      RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "\[Mu]"}], "}"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"declareQNInteger", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"t", "[", 
      RowBox[{"a", ",", "b"}], "]"}], ",", 
     RowBox[{"tp", "[", 
      RowBox[{"a", ",", "b"}], "]"}], ",", 
     RowBox[{"mt", "[", 
      RowBox[{"a", ",", "b"}], "]"}], ",", 
     RowBox[{"mtp", "[", 
      RowBox[{"a", ",", "b"}], "]"}]}], "}"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.60611147578131*^9, 3.6061116012629757`*^9}}],

Cell["Performing the check again:", "Text",
 CellChangeTimes->{{3.606111336295247*^9, 3.606111474663344*^9}, {
  3.606111623543806*^9, 3.606111630551744*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"testExpr", "[", "1", "]"}], "//", "consistencyCheck"}]], "Input",
 CellChangeTimes->{3.606111485625758*^9, 3.60611161661938*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"consistencyCheck", "::", "halfinteger"}], "MessageName"], ":", 
  " ", "\<\"Condition \
\\\"\[NoBreak]\\!\\(\\*TagBox[\\(TraditionalForm\\`\\*TemplateBox[List[RowBox[\
List[RowBox[List[RowBox[List[\\\"-\\\", SubsuperscriptBox[\\\"m\\\", \
SubscriptBox[\\\"t\\\", RowBox[List[\\\"b\\\"]]], \\\"\\\\[Prime]\\\"]]], \
\\\"+\\\", SubscriptBox[\\\"m\\\", SubscriptBox[\\\"t\\\", \
RowBox[List[\\\"b\\\"]]]], \\\"+\\\", \\\"\\\\[Mu]\\\"]], \\\",\\\", \
\\\"0\\\"]]], \\\"KroneckerDeltaSeq\\\"]\\), TraditionalForm, Rule[Editable, \
True]]\\)\[NoBreak]\\\" cannot be fulfilled as the sum of the arguments \
cannot yield an integer\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.606111634324306*^9, 3.6061253835282288`*^9, 
  3.606211250856181*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"consistencyCheck", "::", "halfinteger"}], "MessageName"], ":", 
  " ", "\<\"Condition \
\\\"\[NoBreak]\\!\\(\\*TagBox[\\(TraditionalForm\\`\\*TemplateBox[List[RowBox[\
List[RowBox[List[SubsuperscriptBox[\\\"m\\\", SubscriptBox[\\\"t\\\", \
RowBox[List[\\\"a\\\"]]], \\\"\\\\[Prime]\\\"], \\\"-\\\", SubscriptBox[\\\"m\
\\\", SubscriptBox[\\\"t\\\", RowBox[List[\\\"a\\\"]]]], \\\"+\\\", \
\\\"\\\\[Mu]\\\"]], \\\",\\\", \\\"0\\\"]]], \\\"KroneckerDeltaSeq\\\"]\\), \
TraditionalForm, Rule[Editable, True]]\\)\[NoBreak]\\\" cannot be fulfilled \
as the sum of the arguments cannot yield an integer\"\>"}]], "Message", "MSG",
 
 CellChangeTimes->{3.606111634324306*^9, 3.6061253835282288`*^9, 
  3.606211250935183*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"consistencyCheck", "::", "projection"}], "MessageName"], ":", 
  " ", "\<\"Symbols \\\"\[NoBreak]\\!\\(\\*TagBox[\\(TraditionalForm\\`1\\), \
TraditionalForm, Rule[Editable, True]]\\)\[NoBreak]\\\" and \\\"\[NoBreak]\\!\
\\(\\*TagBox[\\(TraditionalForm\\`\[Mu]\\), TraditionalForm, Rule[Editable, \
True]]\\)\[NoBreak]\\\" have not been declared consistently, e.g. one might \
be an integer and the other is a half-integer\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.606111634324306*^9, 3.6061253835282288`*^9, 
  3.606211251049304*^9}]
}, Open  ]],

Cell["\<\
There are still errors. They tell us that mt[b]+mtp[b]+\[Mu] cannot be an \
integer and that the symbols \[OpenCurlyDoubleQuote]1\[CloseCurlyDoubleQuote] \
and \[OpenCurlyDoubleQuote]\[Mu]\[CloseCurlyDoubleQuote] seem to be \
inconsistent. In fact, we did an error in the declaration above: We declared \
\[Mu] to be a half-integer. However, it must be an integer. Lets try to \
correct that:\
\>", "Text",
 CellChangeTimes->{{3.606111336295247*^9, 3.606111474663344*^9}, {
  3.606111623543806*^9, 3.606111743464181*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"declareQNInteger", "[", "\[Mu]", "]"}]], "Input",
 CellChangeTimes->{{3.606111750188449*^9, 3.60611175143486*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"declareQNInteger", "::", "doubledefinition"}], "MessageName"], 
  ":", " ", "\<\"Symbol \[NoBreak]\\!\\(\[Mu]\\)\[NoBreak] has been declared \
a half-integer quantum number already\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.606111752480803*^9, 3.606125385511077*^9, 
  3.6062112560784063`*^9}],

Cell[BoxData["None"], "Output",
 CellChangeTimes->{3.606111752482917*^9, 3.606125385512335*^9, 
  3.6062112560805597`*^9}]
}, Open  ]],

Cell["\<\
Trying to declare \[Mu] an integer now fails, as it has been declared a \
half-integer already. However, if we are sure we want to change this, we can \
force the declaration to work:\
\>", "Text",
 CellChangeTimes->{{3.606111336295247*^9, 3.606111474663344*^9}, {
  3.606111623543806*^9, 3.6061118038314962`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"declareQNInteger", "[", 
  RowBox[{"\[Mu]", ",", 
   RowBox[{"Overwrite", "\[Rule]", " ", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.606111809243783*^9, 3.606111812155233*^9}}],

Cell[BoxData["\[Mu]"], "Output",
 CellChangeTimes->{
  3.606111814950161*^9, 3.606125386838475*^9, 3.6062035603259563`*^9, {
   3.606211257895483*^9, 3.6062112612168407`*^9}}]
}, Open  ]],

Cell["\<\
Now \[Mu] is declared an integer and we perform the consistency Check again:\
\>", "Text",
 CellChangeTimes->{{3.606111336295247*^9, 3.606111474663344*^9}, {
  3.606111623543806*^9, 3.6061118384714413`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"testExpr", "[", "1", "]"}], "//", "consistencyCheck"}]], "Input"],

Cell[TextData[{
 "No errors should appear now. Great, ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " knows all it should and we perform simplification using the function \
simplifyAMSum. It may take a while and one should use the option Print->True \
as it prints the expression it is currently working on. This function is far \
from finished and it has the nasty habit of never finishing if it cannot \
simplify the rule any further."
}], "Text",
 CellChangeTimes->{{3.6061118564561787`*^9, 3.606111884952417*^9}, {
  3.6061119311766872`*^9, 3.606112018712315*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"result", "[", "1", "]"}], "=", 
  RowBox[{"simplifyAMSum", "[", 
   RowBox[{
    RowBox[{"testExpr", "[", "1", "]"}], ",", 
    RowBox[{"Print", "\[Rule]", "True"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.606111918364449*^9, 3.6061119284096937`*^9}, {
  3.606123556587594*^9, 3.6061235575634527`*^9}, {3.606212255752194*^9, 
  3.606212257418415*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  FormBox[
   RowBox[{
    UnderscriptBox["\[Sum]", "\[Mu]"], 
    RowBox[{
     UnderscriptBox["\[Sum]", 
      SubscriptBox["m", 
       SubscriptBox["t", "a"]]], 
     RowBox[{
      UnderscriptBox["\[Sum]", 
       SubscriptBox["m", 
        SubscriptBox["t", "b"]]], 
      RowBox[{
       UnderscriptBox["\[Sum]", 
        SubscriptBox["m", 
         SubscriptBox["t", "c"]]], 
       RowBox[{
        UnderscriptBox["\[Sum]", 
         SubscriptBox["m", 
          SubscriptBox["t", 
           RowBox[{"a", "\[InvisibleComma]", "b"}]]]], 
        RowBox[{
         UnderscriptBox["\[Sum]", 
          SubsuperscriptBox["m", 
           SubscriptBox["t", "a"], "\[Prime]"]], 
         RowBox[{
          UnderscriptBox["\[Sum]", 
           SubsuperscriptBox["m", 
            SubscriptBox["t", "b"], "\[Prime]"]], 
          RowBox[{
           UnderscriptBox["\[Sum]", 
            SubsuperscriptBox["m", 
             SubscriptBox["t", 
              RowBox[{"a", "\[InvisibleComma]", "b"}]], "\[Prime]"]], 
           RowBox[{"6", " ", 
            SqrtBox[
             RowBox[{
              RowBox[{"2", " ", 
               SubscriptBox["t", 
                RowBox[{"a", "\[InvisibleComma]", "b"}]]}], "+", "1"}]], " ", 
            
            SqrtBox[
             RowBox[{
              RowBox[{"2", " ", 
               SubscriptBox["t", 
                RowBox[{
                "a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}]]}], 
              "+", "1"}]], " ", 
            SqrtBox[
             RowBox[{
              RowBox[{"2", " ", 
               SubsuperscriptBox["t", 
                RowBox[{"a", "\[InvisibleComma]", "b"}], "\[Prime]"]}], "+", 
              "1"}]], " ", 
            RowBox[{
             TagBox[
              StyleBox["(",
               SpanMaxSize->DirectedInfinity[1]],
              ThreeJSymbol], "\[MediumSpace]", GridBox[{
               {
                FractionBox["1", "2"], 
                FractionBox["1", "2"], 
                SubscriptBox["t", 
                 RowBox[{"a", "\[InvisibleComma]", "b"}]]},
               {
                SubscriptBox["m", 
                 SubscriptBox["t", "a"]], 
                SubscriptBox["m", 
                 SubscriptBox["t", "b"]], 
                RowBox[{"-", 
                 SubscriptBox["m", 
                  SubscriptBox["t", 
                   RowBox[{"a", "\[InvisibleComma]", "b"}]]]}]}
              }], "\[MediumSpace]", 
             TagBox[
              StyleBox[")",
               SpanMaxSize->DirectedInfinity[1]],
              ThreeJSymbol]}], " ", 
            RowBox[{
             TagBox[
              StyleBox["(",
               SpanMaxSize->DirectedInfinity[1]],
              ThreeJSymbol], "\[MediumSpace]", GridBox[{
               {
                FractionBox["1", "2"], "1", 
                FractionBox["1", "2"]},
               {
                SubsuperscriptBox["m", 
                 SubscriptBox["t", "a"], "\[Prime]"], "\[Mu]", 
                RowBox[{"-", 
                 SubscriptBox["m", 
                  SubscriptBox["t", "a"]]}]}
              }], "\[MediumSpace]", 
             TagBox[
              StyleBox[")",
               SpanMaxSize->DirectedInfinity[1]],
              ThreeJSymbol]}], " ", 
            RowBox[{
             TagBox[
              StyleBox["(",
               SpanMaxSize->DirectedInfinity[1]],
              ThreeJSymbol], "\[MediumSpace]", GridBox[{
               {
                FractionBox["1", "2"], "1", 
                FractionBox["1", "2"]},
               {
                SubscriptBox["m", 
                 SubscriptBox["t", "b"]], "\[Mu]", 
                RowBox[{"-", 
                 SubsuperscriptBox["m", 
                  SubscriptBox["t", "b"], "\[Prime]"]}]}
              }], "\[MediumSpace]", 
             TagBox[
              StyleBox[")",
               SpanMaxSize->DirectedInfinity[1]],
              ThreeJSymbol]}], " ", 
            SqrtBox[
             RowBox[{
              RowBox[{"2", " ", 
               SubsuperscriptBox["t", 
                RowBox[{
                "a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}], 
                "\[Prime]"]}], "+", "1"}]], " ", 
            RowBox[{
             TagBox[
              StyleBox["(",
               SpanMaxSize->DirectedInfinity[1]],
              ThreeJSymbol], "\[MediumSpace]", GridBox[{
               {
                SubscriptBox["t", 
                 RowBox[{"a", "\[InvisibleComma]", "b"}]], 
                FractionBox["1", "2"], 
                SubscriptBox["t", 
                 RowBox[{
                 "a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}]]},
               {
                SubscriptBox["m", 
                 SubscriptBox["t", 
                  RowBox[{"a", "\[InvisibleComma]", "b"}]]], 
                SubscriptBox["m", 
                 SubscriptBox["t", "c"]], 
                RowBox[{"-", 
                 SubscriptBox["m", 
                  SubscriptBox["t", 
                   RowBox[{
                   "a", "\[InvisibleComma]", "b", "\[InvisibleComma]", 
                    "c"}]]]}]}
              }], "\[MediumSpace]", 
             TagBox[
              StyleBox[")",
               SpanMaxSize->DirectedInfinity[1]],
              ThreeJSymbol]}], " ", 
            RowBox[{
             TagBox[
              StyleBox["(",
               SpanMaxSize->DirectedInfinity[1]],
              ThreeJSymbol], "\[MediumSpace]", GridBox[{
               {
                FractionBox["1", "2"], 
                FractionBox["1", "2"], 
                SubsuperscriptBox["t", 
                 RowBox[{"a", "\[InvisibleComma]", "b"}], "\[Prime]"]},
               {
                SubsuperscriptBox["m", 
                 SubscriptBox["t", "a"], "\[Prime]"], 
                SubsuperscriptBox["m", 
                 SubscriptBox["t", "b"], "\[Prime]"], 
                RowBox[{"-", 
                 SubsuperscriptBox["m", 
                  SubscriptBox["t", 
                   RowBox[{"a", "\[InvisibleComma]", "b"}]], "\[Prime]"]}]}
              }], "\[MediumSpace]", 
             TagBox[
              StyleBox[")",
               SpanMaxSize->DirectedInfinity[1]],
              ThreeJSymbol]}], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], 
             RowBox[{
              RowBox[{"-", 
               SubsuperscriptBox["m", 
                SubscriptBox["t", 
                 RowBox[{
                 "a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}]], 
                "\[Prime]"]}], "-", 
              SubscriptBox["m", 
               SubscriptBox["t", 
                RowBox[{
                "a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}]]], 
              "-", 
              SubsuperscriptBox["m", 
               SubscriptBox["t", 
                RowBox[{"a", "\[InvisibleComma]", "b"}]], "\[Prime]"], "-", 
              SubscriptBox["m", 
               SubscriptBox["t", 
                RowBox[{"a", "\[InvisibleComma]", "b"}]]], "-", 
              SubsuperscriptBox["t", 
               RowBox[{"a", "\[InvisibleComma]", "b"}], "\[Prime]"], "-", 
              SubscriptBox["t", 
               RowBox[{"a", "\[InvisibleComma]", "b"}]], "-", 
              SubscriptBox["m", 
               SubscriptBox["t", "a"]], "-", 
              SubsuperscriptBox["m", 
               SubscriptBox["t", "b"], "\[Prime]"], "+", "2"}]], " ", 
            RowBox[{
             TagBox[
              StyleBox["(",
               SpanMaxSize->DirectedInfinity[1]],
              ThreeJSymbol], "\[MediumSpace]", GridBox[{
               {
                SubsuperscriptBox["t", 
                 RowBox[{"a", "\[InvisibleComma]", "b"}], "\[Prime]"], 
                FractionBox["1", "2"], 
                SubsuperscriptBox["t", 
                 RowBox[{
                 "a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}], 
                 "\[Prime]"]},
               {
                SubsuperscriptBox["m", 
                 SubscriptBox["t", 
                  RowBox[{"a", "\[InvisibleComma]", "b"}]], "\[Prime]"], 
                SubscriptBox["m", 
                 SubscriptBox["t", "c"]], 
                RowBox[{"-", 
                 SubsuperscriptBox["m", 
                  SubscriptBox["t", 
                   RowBox[{
                   "a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}]],
                   "\[Prime]"]}]}
              }], "\[MediumSpace]", 
             TagBox[
              StyleBox[")",
               SpanMaxSize->DirectedInfinity[1]],
              ThreeJSymbol]}]}]}]}]}]}]}]}]}]}],
   TraditionalForm],
  TraditionalForm,
  Editable->True]], "Print",
 CellChangeTimes->{3.6061192455040092`*^9, 3.606123560812518*^9, 
  3.606125390855733*^9, 3.6062035660271597`*^9, 3.606211290867858*^9}],

Cell[BoxData[
 TagBox[
  FormBox[
   RowBox[{
    UnderscriptBox["\[Sum]", 
     SubscriptBox["m", 
      SubscriptBox["t", "c"]]], 
    RowBox[{
     UnderscriptBox["\[Sum]", 
      SubscriptBox["m", 
       SubscriptBox["t", 
        RowBox[{"a", "\[InvisibleComma]", "b"}]]]], 
     RowBox[{
      UnderscriptBox["\[Sum]", 
       SubsuperscriptBox["m", 
        SubscriptBox["t", "a"], "\[Prime]"]], 
      RowBox[{
       UnderscriptBox["\[Sum]", 
        SubsuperscriptBox["m", 
         SubscriptBox["t", "b"], "\[Prime]"]], 
       RowBox[{
        UnderscriptBox["\[Sum]", 
         SubsuperscriptBox["m", 
          SubscriptBox["t", 
           RowBox[{"a", "\[InvisibleComma]", "b"}]], "\[Prime]"]], 
        RowBox[{
         RowBox[{"-", "6"}], " ", "\[ImaginaryI]", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"2", " ", 
            SubscriptBox["t", 
             RowBox[{"a", "\[InvisibleComma]", "b"}]]}], "+", "1"}]], " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"2", " ", 
            SubscriptBox["t", 
             RowBox[{
             "a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}]]}], 
           "+", "1"}]], " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"2", " ", 
            SubsuperscriptBox["t", 
             RowBox[{"a", "\[InvisibleComma]", "b"}], "\[Prime]"]}], "+", 
           "1"}]], " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"2", " ", 
            SubsuperscriptBox["t", 
             RowBox[{
             "a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}], 
             "\[Prime]"]}], "+", "1"}]], " ", 
         RowBox[{
          TagBox[
           StyleBox["{",
            SpanMaxSize->DirectedInfinity[1]],
           SixJSymbol], "\[MediumSpace]", GridBox[{
            {"1", 
             FractionBox["1", "2"], 
             FractionBox["1", "2"]},
            {
             SubscriptBox["t", 
              RowBox[{"a", "\[InvisibleComma]", "b"}]], 
             FractionBox["1", "2"], 
             FractionBox["1", "2"]}
           }], "\[MediumSpace]", 
          TagBox[
           StyleBox["}",
            SpanMaxSize->DirectedInfinity[1]],
           SixJSymbol]}], " ", 
         RowBox[{
          TagBox[
           StyleBox["(",
            SpanMaxSize->DirectedInfinity[1]],
           ThreeJSymbol], "\[MediumSpace]", GridBox[{
            {
             SubscriptBox["t", 
              RowBox[{"a", "\[InvisibleComma]", "b"}]], 
             FractionBox["1", "2"], 
             SubscriptBox["t", 
              RowBox[{
              "a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}]]},
            {
             SubscriptBox["m", 
              SubscriptBox["t", 
               RowBox[{"a", "\[InvisibleComma]", "b"}]]], 
             SubscriptBox["m", 
              SubscriptBox["t", "c"]], 
             RowBox[{"-", 
              SubscriptBox["m", 
               SubscriptBox["t", 
                RowBox[{
                "a", "\[InvisibleComma]", "b", "\[InvisibleComma]", 
                 "c"}]]]}]}
           }], "\[MediumSpace]", 
          TagBox[
           StyleBox[")",
            SpanMaxSize->DirectedInfinity[1]],
           ThreeJSymbol]}], " ", 
         RowBox[{
          TagBox[
           StyleBox["(",
            SpanMaxSize->DirectedInfinity[1]],
           ThreeJSymbol], "\[MediumSpace]", GridBox[{
            {
             FractionBox["1", "2"], 
             FractionBox["1", "2"], 
             SubsuperscriptBox["t", 
              RowBox[{"a", "\[InvisibleComma]", "b"}], "\[Prime]"]},
            {
             RowBox[{"-", 
              SubsuperscriptBox["m", 
               SubscriptBox["t", "a"], "\[Prime]"]}], 
             RowBox[{"-", 
              SubsuperscriptBox["m", 
               SubscriptBox["t", "b"], "\[Prime]"]}], 
             SubsuperscriptBox["m", 
              SubscriptBox["t", 
               RowBox[{"a", "\[InvisibleComma]", "b"}]], "\[Prime]"]}
           }], "\[MediumSpace]", 
          TagBox[
           StyleBox[")",
            SpanMaxSize->DirectedInfinity[1]],
           ThreeJSymbol]}], " ", 
         RowBox[{
          TagBox[
           StyleBox["(",
            SpanMaxSize->DirectedInfinity[1]],
           ThreeJSymbol], "\[MediumSpace]", GridBox[{
            {
             SubscriptBox["t", 
              RowBox[{"a", "\[InvisibleComma]", "b"}]], 
             FractionBox["1", "2"], 
             FractionBox["1", "2"]},
            {
             SubscriptBox["m", 
              SubscriptBox["t", 
               RowBox[{"a", "\[InvisibleComma]", "b"}]]], 
             RowBox[{"-", 
              SubsuperscriptBox["m", 
               SubscriptBox["t", "b"], "\[Prime]"]}], 
             RowBox[{"-", 
              SubsuperscriptBox["m", 
               SubscriptBox["t", "a"], "\[Prime]"]}]}
           }], "\[MediumSpace]", 
          TagBox[
           StyleBox[")",
            SpanMaxSize->DirectedInfinity[1]],
           ThreeJSymbol]}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{
           SubsuperscriptBox["m", 
            SubscriptBox["t", 
             RowBox[{
             "a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}]], 
            "\[Prime]"], "+", 
           SubsuperscriptBox["t", 
            RowBox[{"a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}],
             "\[Prime]"], "+", 
           SubsuperscriptBox["m", 
            SubscriptBox["t", 
             RowBox[{"a", "\[InvisibleComma]", "b"}]], "\[Prime]"], "+", 
           SubscriptBox["m", 
            SubscriptBox["t", 
             RowBox[{"a", "\[InvisibleComma]", "b"}]]], "+", 
           SubsuperscriptBox["t", 
            RowBox[{"a", "\[InvisibleComma]", "b"}], "\[Prime]"], "+", 
           SubsuperscriptBox["m", 
            SubscriptBox["t", "a"], "\[Prime]"], "+", 
           SubsuperscriptBox["m", 
            SubscriptBox["t", "b"], "\[Prime]"], "+", 
           SubscriptBox["m", 
            SubscriptBox["t", "c"]]}]], " ", 
         RowBox[{
          TagBox[
           StyleBox["(",
            SpanMaxSize->DirectedInfinity[1]],
           ThreeJSymbol], "\[MediumSpace]", GridBox[{
            {
             SubsuperscriptBox["t", 
              RowBox[{"a", "\[InvisibleComma]", "b"}], "\[Prime]"], 
             FractionBox["1", "2"], 
             SubsuperscriptBox["t", 
              RowBox[{
              "a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}], 
              "\[Prime]"]},
            {
             RowBox[{"-", 
              SubsuperscriptBox["m", 
               SubscriptBox["t", 
                RowBox[{"a", "\[InvisibleComma]", "b"}]], "\[Prime]"]}], 
             RowBox[{"-", 
              SubscriptBox["m", 
               SubscriptBox["t", "c"]]}], 
             SubsuperscriptBox["m", 
              SubscriptBox["t", 
               RowBox[{
               "a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}]], 
              "\[Prime]"]}
           }], "\[MediumSpace]", 
          TagBox[
           StyleBox[")",
            SpanMaxSize->DirectedInfinity[1]],
           ThreeJSymbol]}]}]}]}]}]}]}],
   TraditionalForm],
  TraditionalForm,
  Editable->True]], "Print",
 CellChangeTimes->{3.6061192455040092`*^9, 3.606123560812518*^9, 
  3.606125390855733*^9, 3.6062035660271597`*^9, 3.606211297896738*^9}],

Cell[BoxData[
 TagBox[
  FormBox[
   RowBox[{
    UnderscriptBox["\[Sum]", 
     SubscriptBox["m", 
      SubscriptBox["t", "c"]]], 
    RowBox[{
     UnderscriptBox["\[Sum]", 
      SubscriptBox["m", 
       SubscriptBox["t", 
        RowBox[{"a", "\[InvisibleComma]", "b"}]]]], 
     RowBox[{"6", " ", "\[ImaginaryI]", " ", 
      SqrtBox[
       RowBox[{
        RowBox[{"2", " ", 
         SubscriptBox["t", 
          RowBox[{
          "a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}]]}], "+", 
        "1"}]], " ", 
      SqrtBox[
       RowBox[{
        RowBox[{"2", " ", 
         SubsuperscriptBox["t", 
          RowBox[{"a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}], 
          "\[Prime]"]}], "+", "1"}]], " ", 
      RowBox[{
       TagBox[
        StyleBox["{",
         SpanMaxSize->DirectedInfinity[1]],
        SixJSymbol], "\[MediumSpace]", GridBox[{
         {"1", 
          FractionBox["1", "2"], 
          FractionBox["1", "2"]},
         {
          SubscriptBox["t", 
           RowBox[{"a", "\[InvisibleComma]", "b"}]], 
          FractionBox["1", "2"], 
          FractionBox["1", "2"]}
        }], "\[MediumSpace]", 
       TagBox[
        StyleBox["}",
         SpanMaxSize->DirectedInfinity[1]],
        SixJSymbol]}], " ", 
      TemplateBox[{RowBox[{
          SubscriptBox["t", 
           RowBox[{"a", "\[InvisibleComma]", "b"}]], ",", 
          SubsuperscriptBox["t", 
           RowBox[{"a", "\[InvisibleComma]", "b"}], "\[Prime]"]}]},
       "KroneckerDeltaSeq"], " ", 
      RowBox[{
       TagBox[
        StyleBox["(",
         SpanMaxSize->DirectedInfinity[1]],
        ThreeJSymbol], "\[MediumSpace]", GridBox[{
         {
          SubscriptBox["t", 
           RowBox[{"a", "\[InvisibleComma]", "b"}]], 
          FractionBox["1", "2"], 
          SubscriptBox["t", 
           RowBox[{"a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}]]},
         {
          SubscriptBox["m", 
           SubscriptBox["t", 
            RowBox[{"a", "\[InvisibleComma]", "b"}]]], 
          SubscriptBox["m", 
           SubscriptBox["t", "c"]], 
          RowBox[{"-", 
           SubscriptBox["m", 
            SubscriptBox["t", 
             RowBox[{
             "a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}]]]}]}
        }], "\[MediumSpace]", 
       TagBox[
        StyleBox[")",
         SpanMaxSize->DirectedInfinity[1]],
        ThreeJSymbol]}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{
        SubsuperscriptBox["m", 
         SubscriptBox["t", 
          RowBox[{"a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}]], 
         "\[Prime]"], "+", 
        SubsuperscriptBox["t", 
         RowBox[{"a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}], 
         "\[Prime]"], "+", 
        SubscriptBox["m", 
         SubscriptBox["t", 
          RowBox[{"a", "\[InvisibleComma]", "b"}]]], "+", 
        SubscriptBox["m", 
         SubscriptBox["t", "c"]]}]], " ", 
      RowBox[{
       TagBox[
        StyleBox["(",
         SpanMaxSize->DirectedInfinity[1]],
        ThreeJSymbol], "\[MediumSpace]", GridBox[{
         {
          SubscriptBox["t", 
           RowBox[{"a", "\[InvisibleComma]", "b"}]], 
          FractionBox["1", "2"], 
          SubsuperscriptBox["t", 
           RowBox[{"a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}], 
           "\[Prime]"]},
         {
          RowBox[{"-", 
           SubscriptBox["m", 
            SubscriptBox["t", 
             RowBox[{"a", "\[InvisibleComma]", "b"}]]]}], 
          RowBox[{"-", 
           SubscriptBox["m", 
            SubscriptBox["t", "c"]]}], 
          SubsuperscriptBox["m", 
           SubscriptBox["t", 
            RowBox[{
            "a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}]], 
           "\[Prime]"]}
        }], "\[MediumSpace]", 
       TagBox[
        StyleBox[")",
         SpanMaxSize->DirectedInfinity[1]],
        ThreeJSymbol]}]}]}]}],
   TraditionalForm],
  TraditionalForm,
  Editable->True]], "Print",
 CellChangeTimes->{3.6061192455040092`*^9, 3.606123560812518*^9, 
  3.606125390855733*^9, 3.6062035660271597`*^9, 3.606211298189309*^9}],

Cell[BoxData[
 TagBox[
  FormBox[
   RowBox[{
    RowBox[{"-", "6"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], 
     SubscriptBox["t", 
      RowBox[{"a", "\[InvisibleComma]", "b"}]]], " ", 
    RowBox[{
     TagBox[
      StyleBox["{",
       SpanMaxSize->DirectedInfinity[1]],
      SixJSymbol], "\[MediumSpace]", GridBox[{
       {"1", 
        FractionBox["1", "2"], 
        FractionBox["1", "2"]},
       {
        SubscriptBox["t", 
         RowBox[{"a", "\[InvisibleComma]", "b"}]], 
        FractionBox["1", "2"], 
        FractionBox["1", "2"]}
      }], "\[MediumSpace]", 
     TagBox[
      StyleBox["}",
       SpanMaxSize->DirectedInfinity[1]],
      SixJSymbol]}], " ", 
    TemplateBox[{RowBox[{
        SubscriptBox["t", 
         RowBox[{"a", "\[InvisibleComma]", "b"}]], ",", 
        SubsuperscriptBox["t", 
         RowBox[{"a", "\[InvisibleComma]", "b"}], "\[Prime]"]}]},
     "KroneckerDeltaSeq"], " ", 
    StyleBox[
     RowBox[{"\[EmptyUpTriangle]", "{", 
      FractionBox["1", "2"], 
      SubscriptBox["t", 
       RowBox[{"a", "\[InvisibleComma]", "b"}]], 
      SubscriptBox["t", 
       RowBox[{"a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}]], 
      "}"}],
     SpanMaxSize->DirectedInfinity[1]], " ", 
    TemplateBox[{RowBox[{
        SubscriptBox["t", 
         RowBox[{"a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}]], 
        ",", 
        SubsuperscriptBox["t", 
         RowBox[{"a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}], 
         "\[Prime]"]}]},
     "KroneckerDeltaSeq"], " ", 
    TemplateBox[{RowBox[{
        SubscriptBox["m", 
         SubscriptBox["t", 
          RowBox[{"a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}]]],
         ",", 
        SubsuperscriptBox["m", 
         SubscriptBox["t", 
          RowBox[{"a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}]], 
         "\[Prime]"]}]},
     "KroneckerDeltaSeq"]}],
   TraditionalForm],
  TraditionalForm,
  Editable->True]], "Print",
 CellChangeTimes->{3.6061192455040092`*^9, 3.606123560812518*^9, 
  3.606125390855733*^9, 3.6062035660271597`*^9, 3.606211298237307*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "6"}], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"-", "1"}], ")"}], 
   RowBox[{"t", "[", 
    RowBox[{"a", ",", "b"}], "]"}]], " ", 
  RowBox[{"conTri", "[", 
   RowBox[{
    FractionBox["1", "2"], ",", 
    RowBox[{"t", "[", 
     RowBox[{"a", ",", "b"}], "]"}], ",", 
    RowBox[{"t", "[", 
     RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], "]"}], " ", 
  RowBox[{"KroneckerDelta", "[", 
   RowBox[{
    RowBox[{"mt", "[", 
     RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", 
    RowBox[{"mtp", "[", 
     RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], "]"}], " ", 
  RowBox[{"KroneckerDelta", "[", 
   RowBox[{
    RowBox[{"t", "[", 
     RowBox[{"a", ",", "b"}], "]"}], ",", 
    RowBox[{"tp", "[", 
     RowBox[{"a", ",", "b"}], "]"}]}], "]"}], " ", 
  RowBox[{"KroneckerDelta", "[", 
   RowBox[{
    RowBox[{"t", "[", 
     RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", 
    RowBox[{"tp", "[", 
     RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], "]"}], " ", 
  RowBox[{"sj", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", 
      FractionBox["1", "2"], ",", 
      FractionBox["1", "2"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"t", "[", 
       RowBox[{"a", ",", "b"}], "]"}], ",", 
      FractionBox["1", "2"], ",", 
      FractionBox["1", "2"]}], "}"}]}], "]"}]}]], "Output",
 CellChangeTimes->{3.606119252791333*^9, 3.606123568400893*^9, 
  3.606125398279892*^9, 3.6062035734560204`*^9, 3.606211298240551*^9}]
}, Open  ]],

Cell["\<\
Obviously, the result can be presented in a more readable way:\
\>", "Text",
 CellChangeTimes->{{3.6061192739076967`*^9, 3.6061192910431547`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"result", "[", "1", "]"}], "//", "TraditionalForm"}]], "Input",
 CellChangeTimes->{{3.6061192927034597`*^9, 3.606119294570187*^9}, {
  3.606123563399467*^9, 3.6061235659749603`*^9}, {3.6062122597529078`*^9, 
  3.606212259959917*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"-", "6"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"-", "1"}], ")"}], 
    SubscriptBox["t", 
     RowBox[{"a", "\[InvisibleComma]", "b"}]]], " ", 
   RowBox[{
    TagBox[
     StyleBox["{",
      SpanMaxSize->DirectedInfinity[1]],
     SixJSymbol], "\[MediumSpace]", GridBox[{
      {"1", 
       FractionBox["1", "2"], 
       FractionBox["1", "2"]},
      {
       SubscriptBox["t", 
        RowBox[{"a", "\[InvisibleComma]", "b"}]], 
       FractionBox["1", "2"], 
       FractionBox["1", "2"]}
     }], "\[MediumSpace]", 
    TagBox[
     StyleBox["}",
      SpanMaxSize->DirectedInfinity[1]],
     SixJSymbol]}], " ", 
   TemplateBox[{RowBox[{
       SubscriptBox["t", 
        RowBox[{"a", "\[InvisibleComma]", "b"}]], ",", 
       SubsuperscriptBox["t", 
        RowBox[{"a", "\[InvisibleComma]", "b"}], "\[Prime]"]}]},
    "KroneckerDeltaSeq"], " ", 
   StyleBox[
    RowBox[{"\[EmptyUpTriangle]", "{", 
     FractionBox["1", "2"], 
     SubscriptBox["t", 
      RowBox[{"a", "\[InvisibleComma]", "b"}]], 
     SubscriptBox["t", 
      RowBox[{"a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}]], 
     "}"}],
    SpanMaxSize->DirectedInfinity[1]], " ", 
   TemplateBox[{RowBox[{
       SubscriptBox["t", 
        RowBox[{"a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}]], 
       ",", 
       SubsuperscriptBox["t", 
        RowBox[{"a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}], 
        "\[Prime]"]}]},
    "KroneckerDeltaSeq"], " ", 
   TemplateBox[{RowBox[{
       SubscriptBox["m", 
        SubscriptBox["t", 
         RowBox[{"a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}]]], 
       ",", 
       SubsuperscriptBox["m", 
        SubscriptBox["t", 
         RowBox[{"a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}]], 
        "\[Prime]"]}]},
    "KroneckerDeltaSeq"]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.606119295032076*^9, 3.606123571420947*^9, 
  3.606125410998414*^9, 3.6062035809366217`*^9, 3.606211304660562*^9}]
}, Open  ]],

Cell["\<\
A warning about  this AngularMomentum framework. At the moment it has not \
been tested thoroughly. Therefore you should expect errors. Furthermore it is \
not finished, any expression involving 9j symbols should always use the \
OnlySums option - otherwise it may get stuck in some infinite loop.
However, I do not intend to extend this package to all possible cases, which \
might never actually appear in a real application. Nonetheless there will be \
updates and if you have an expression that can be simplified and this package \
is not able to do it, let me know: schulz@theorie.ikp.physik.tu-darmstadt.de
In all cases it is a good idea to use the simplification with Print->True and \
double check the calculation. Again, if you find any errors, please let me \
know.\
\>", "Text",
 CellChangeTimes->{{3.606119793107478*^9, 3.6061199950127077`*^9}, {
  3.6061221522625647`*^9, 3.606122165334873*^9}, {3.6061232481034718`*^9, 
  3.606123324230801*^9}, {3.615889233935581*^9, 3.61588927866912*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Richards Formula", "Section",
 CellChangeTimes->{{3.6062113556036997`*^9, 3.606211360498744*^9}, {
  3.6062193804161263`*^9, 3.6062193823508587`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testExpr", "[", "2", "]"}], "=", 
   RowBox[{"sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"cg", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jp", "[", "1", "]"}], ",", 
          RowBox[{"mjp", "[", "1", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jp", "[", "2", "]"}], ",", 
          RowBox[{"mjp", "[", "2", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jp", "[", 
           RowBox[{"1", ",", "2"}], "]"}], ",", 
          RowBox[{"mjp", "[", 
           RowBox[{"1", ",", "2"}], "]"}]}], "}"}]}], "]"}], 
      RowBox[{"cg", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jh", "[", "1", "]"}], ",", 
          RowBox[{"mjh", "[", "1", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jh", "[", "2", "]"}], ",", 
          RowBox[{"mjh", "[", "2", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jh", "[", 
           RowBox[{"1", ",", "2"}], "]"}], ",", 
          RowBox[{"mjh", "[", 
           RowBox[{"1", ",", "2"}], "]"}]}], "}"}]}], "]"}], 
      RowBox[{"cg", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jp", "[", 
           RowBox[{"1", ",", "2"}], "]"}], ",", 
          RowBox[{"mjp", "[", 
           RowBox[{"1", ",", "2"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jh", "[", 
           RowBox[{"1", ",", "2"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"mjh", "[", 
            RowBox[{"1", ",", "2"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0"}], "}"}]}], "]"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"jh", "[", 
          RowBox[{"1", ",", "2"}], "]"}], "-", 
         RowBox[{"mjh", "[", 
          RowBox[{"1", ",", "2"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"cg", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jpp", "[", "1", "]"}], ",", 
          RowBox[{"mjpp", "[", "1", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jpp", "[", "2", "]"}], ",", 
          RowBox[{"mjpp", "[", "2", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jpp", "[", 
           RowBox[{"1", ",", "2"}], "]"}], ",", 
          RowBox[{"mjpp", "[", 
           RowBox[{"1", ",", "2"}], "]"}]}], "}"}]}], "]"}], 
      RowBox[{"cg", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jhp", "[", "1", "]"}], ",", 
          RowBox[{"mjhp", "[", "1", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jhp", "[", "2", "]"}], ",", 
          RowBox[{"mjhp", "[", "2", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jhp", "[", 
           RowBox[{"1", ",", "2"}], "]"}], ",", 
          RowBox[{"mjhp", "[", 
           RowBox[{"1", ",", "2"}], "]"}]}], "}"}]}], "]"}], 
      RowBox[{"cg", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jpp", "[", 
           RowBox[{"1", ",", "2"}], "]"}], ",", 
          RowBox[{"mjpp", "[", 
           RowBox[{"1", ",", "2"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jhp", "[", 
           RowBox[{"1", ",", "2"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"mjhp", "[", 
            RowBox[{"1", ",", "2"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0"}], "}"}]}], "]"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"jhp", "[", 
          RowBox[{"1", ",", "2"}], "]"}], "-", 
         RowBox[{"mjhp", "[", 
          RowBox[{"1", ",", "2"}], "]"}]}], ")"}]}], 
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{
        RowBox[{"jh", "[", "1", "]"}], ",", 
        RowBox[{"jhp", "[", "1", "]"}]}], "]"}], 
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{
        RowBox[{"mjh", "[", "1", "]"}], ",", 
        RowBox[{"mjhp", "[", "1", "]"}]}], "]"}], "\[IndentingNewLine]", 
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{
        RowBox[{"jp", "[", "1", "]"}], ",", 
        RowBox[{"jpp", "[", "1", "]"}]}], "]"}], 
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{
        RowBox[{"mjp", "[", "1", "]"}], ",", 
        RowBox[{"mjpp", "[", "1", "]"}]}], "]"}], "\[IndentingNewLine]", 
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{
        RowBox[{"mjh", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"mjp", "[", 
         RowBox[{"1", ",", "2"}], "]"}]}], "]"}], 
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{
        RowBox[{"mjhp", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"mjpp", "[", 
         RowBox[{"1", ",", "2"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
     ",", 
     RowBox[{"mjp", "[", "1", "]"}], ",", 
     RowBox[{"mjp", "[", "2", "]"}], ",", 
     RowBox[{"mjh", "[", "1", "]"}], ",", 
     RowBox[{"mjh", "[", "2", "]"}], ",", 
     RowBox[{"mjpp", "[", "1", "]"}], ",", 
     RowBox[{"mjpp", "[", "2", "]"}], ",", 
     RowBox[{"mjhp", "[", "1", "]"}], ",", 
     RowBox[{"mjhp", "[", "2", "]"}], ",", 
     RowBox[{"mjp", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"mjh", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"mjpp", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"mjhp", "[", 
      RowBox[{"1", ",", "2"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"declareIndexedAM", "[", 
   RowBox[{"{", 
    RowBox[{"jp", ",", "jh"}], "}"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.606211363022949*^9, 3.6062113777824497`*^9}, {
   3.606211434919045*^9, 3.606211461879196*^9}, {3.606211502823161*^9, 
   3.6062115459787273`*^9}, {3.6062115978819647`*^9, 3.606211852728549*^9}, {
   3.606211955076665*^9, 3.606211961364614*^9}, {3.606212206885212*^9, 
   3.6062122092359867`*^9}, {3.606212516087813*^9, 3.606212590924464*^9}, 
   3.606212674325849*^9, {3.606212918137348*^9, 3.606212925250701*^9}, {
   3.606213085481372*^9, 3.60621311802665*^9}, {3.606213297975672*^9, 
   3.6062133523338346`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"testExpr", "[", "2", "]"}], "//", "TraditionalForm"}]], "Input",
 CellChangeTimes->{{3.6062118574991417`*^9, 3.6062118654705772`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   UnderscriptBox["\[Sum]", 
    SubscriptBox["m", 
     SubscriptBox["jp", "1"]]], 
   RowBox[{
    UnderscriptBox["\[Sum]", 
     SubscriptBox["m", 
      SubscriptBox["jp", "2"]]], 
    RowBox[{
     UnderscriptBox["\[Sum]", 
      SubscriptBox["m", 
       SubscriptBox["jh", "1"]]], 
     RowBox[{
      UnderscriptBox["\[Sum]", 
       SubscriptBox["m", 
        SubscriptBox["jh", "2"]]], 
      RowBox[{
       UnderscriptBox["\[Sum]", 
        SubsuperscriptBox["m", 
         SubscriptBox["jp", "1"], "\[Prime]"]], 
       RowBox[{
        UnderscriptBox["\[Sum]", 
         SubsuperscriptBox["m", 
          SubscriptBox["jp", "2"], "\[Prime]"]], 
        RowBox[{
         UnderscriptBox["\[Sum]", 
          SubsuperscriptBox["m", 
           SubscriptBox["jh", "1"], "\[Prime]"]], 
         RowBox[{
          UnderscriptBox["\[Sum]", 
           SubsuperscriptBox["m", 
            SubscriptBox["jh", "2"], "\[Prime]"]], 
          RowBox[{
           UnderscriptBox["\[Sum]", 
            SubscriptBox["m", 
             SubscriptBox["jp", 
              RowBox[{"1", "\[InvisibleComma]", "2"}]]]], 
           RowBox[{
            UnderscriptBox["\[Sum]", 
             SubscriptBox["m", 
              SubscriptBox["jh", 
               RowBox[{"1", "\[InvisibleComma]", "2"}]]]], 
            RowBox[{
             UnderscriptBox["\[Sum]", 
              SubsuperscriptBox["m", 
               SubscriptBox["jp", 
                RowBox[{"1", "\[InvisibleComma]", "2"}]], "\[Prime]"]], 
             RowBox[{
              UnderscriptBox["\[Sum]", 
               SubsuperscriptBox["m", 
                SubscriptBox["jh", 
                 RowBox[{"1", "\[InvisibleComma]", "2"}]], "\[Prime]"]], 
              RowBox[{
               TemplateBox[{RowBox[{
                   SubscriptBox["jh", "1"], ",", 
                   SubsuperscriptBox["jh", "1", "\[Prime]"]}]},
                "KroneckerDeltaSeq"], " ", 
               TemplateBox[{RowBox[{
                   SubscriptBox["jp", "1"], ",", 
                   SubsuperscriptBox["jp", "1", "\[Prime]"]}]},
                "KroneckerDeltaSeq"], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], 
                RowBox[{
                 RowBox[{"-", 
                  SubsuperscriptBox["m", 
                   SubscriptBox["jh", 
                    RowBox[{"1", "\[InvisibleComma]", "2"}]], "\[Prime]"]}], 
                 "-", 
                 SubscriptBox["m", 
                  SubscriptBox["jh", 
                   RowBox[{"1", "\[InvisibleComma]", "2"}]]], "+", 
                 SubsuperscriptBox["jh", 
                  RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"], "+", 
                 SubscriptBox["jh", 
                  RowBox[{"1", "\[InvisibleComma]", "2"}]]}]], " ", 
               StyleBox[
                RowBox[{"c", "(", GridBox[{
                   {
                    SubscriptBox["jh", "1"], 
                    SubscriptBox["jh", "2"]},
                   {
                    SubscriptBox["m", 
                    SubscriptBox["jh", "1"]], 
                    SubscriptBox["m", 
                    SubscriptBox["jh", "2"]]}
                  }], "|", GridBox[{
                   {
                    SubscriptBox["jh", 
                    RowBox[{"1", "\[InvisibleComma]", "2"}]]},
                   {
                    SubscriptBox["m", 
                    SubscriptBox["jh", 
                    RowBox[{"1", "\[InvisibleComma]", "2"}]]]}
                  }], ")"}],
                SpanMaxSize->DirectedInfinity[1]], " ", 
               StyleBox[
                RowBox[{"c", "(", GridBox[{
                   {
                    SubscriptBox["jp", "1"], 
                    SubscriptBox["jp", "2"]},
                   {
                    SubscriptBox["m", 
                    SubscriptBox["jp", "1"]], 
                    SubscriptBox["m", 
                    SubscriptBox["jp", "2"]]}
                  }], "|", GridBox[{
                   {
                    SubscriptBox["jp", 
                    RowBox[{"1", "\[InvisibleComma]", "2"}]]},
                   {
                    SubscriptBox["m", 
                    SubscriptBox["jp", 
                    RowBox[{"1", "\[InvisibleComma]", "2"}]]]}
                  }], ")"}],
                SpanMaxSize->DirectedInfinity[1]], " ", 
               TemplateBox[{RowBox[{
                   SubscriptBox["m", 
                    SubscriptBox["jh", "1"]], ",", 
                   SubsuperscriptBox["m", 
                    SubscriptBox["jh", "1"], "\[Prime]"]}]},
                "KroneckerDeltaSeq"], " ", 
               TemplateBox[{RowBox[{
                   SubscriptBox["m", 
                    SubscriptBox["jp", "1"]], ",", 
                   SubsuperscriptBox["m", 
                    SubscriptBox["jp", "1"], "\[Prime]"]}]},
                "KroneckerDeltaSeq"], " ", 
               StyleBox[
                RowBox[{"c", "(", GridBox[{
                   {
                    SubsuperscriptBox["jh", "1", "\[Prime]"], 
                    SubsuperscriptBox["jh", "2", "\[Prime]"]},
                   {
                    SubsuperscriptBox["m", 
                    SubscriptBox["jh", "1"], "\[Prime]"], 
                    SubsuperscriptBox["m", 
                    SubscriptBox["jh", "2"], "\[Prime]"]}
                  }], "|", GridBox[{
                   {
                    SubsuperscriptBox["jh", 
                    RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"]},
                   {
                    SubsuperscriptBox["m", 
                    SubscriptBox["jh", 
                    RowBox[{"1", "\[InvisibleComma]", "2"}]], "\[Prime]"]}
                  }], ")"}],
                SpanMaxSize->DirectedInfinity[1]], " ", 
               StyleBox[
                RowBox[{"c", "(", GridBox[{
                   {
                    SubsuperscriptBox["jp", "1", "\[Prime]"], 
                    SubsuperscriptBox["jp", "2", "\[Prime]"]},
                   {
                    SubsuperscriptBox["m", 
                    SubscriptBox["jp", "1"], "\[Prime]"], 
                    SubsuperscriptBox["m", 
                    SubscriptBox["jp", "2"], "\[Prime]"]}
                  }], "|", GridBox[{
                   {
                    SubsuperscriptBox["jp", 
                    RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"]},
                   {
                    SubsuperscriptBox["m", 
                    SubscriptBox["jp", 
                    RowBox[{"1", "\[InvisibleComma]", "2"}]], "\[Prime]"]}
                  }], ")"}],
                SpanMaxSize->DirectedInfinity[1]], " ", 
               TemplateBox[{RowBox[{
                   SubscriptBox["m", 
                    SubscriptBox["jh", 
                    RowBox[{"1", "\[InvisibleComma]", "2"}]]], ",", 
                   SubscriptBox["m", 
                    SubscriptBox["jp", 
                    RowBox[{"1", "\[InvisibleComma]", "2"}]]]}]},
                "KroneckerDeltaSeq"], " ", 
               StyleBox[
                RowBox[{"c", "(", GridBox[{
                   {
                    SubscriptBox["jp", 
                    RowBox[{"1", "\[InvisibleComma]", "2"}]], 
                    SubscriptBox["jh", 
                    RowBox[{"1", "\[InvisibleComma]", "2"}]]},
                   {
                    SubscriptBox["m", 
                    SubscriptBox["jp", 
                    RowBox[{"1", "\[InvisibleComma]", "2"}]]], 
                    RowBox[{"-", 
                    SubscriptBox["m", 
                    SubscriptBox["jh", 
                    RowBox[{"1", "\[InvisibleComma]", "2"}]]]}]}
                  }], "|", GridBox[{
                   {"j"},
                   {"0"}
                  }], ")"}],
                SpanMaxSize->DirectedInfinity[1]], " ", 
               TemplateBox[{RowBox[{
                   SubsuperscriptBox["m", 
                    SubscriptBox["jh", 
                    RowBox[{"1", "\[InvisibleComma]", "2"}]], "\[Prime]"], 
                   ",", 
                   SubsuperscriptBox["m", 
                    SubscriptBox["jp", 
                    RowBox[{"1", "\[InvisibleComma]", "2"}]], "\[Prime]"]}]},
                "KroneckerDeltaSeq"], " ", 
               StyleBox[
                RowBox[{"c", "(", GridBox[{
                   {
                    SubsuperscriptBox["jp", 
                    RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"], 
                    SubsuperscriptBox["jh", 
                    RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"]},
                   {
                    SubsuperscriptBox["m", 
                    SubscriptBox["jp", 
                    RowBox[{"1", "\[InvisibleComma]", "2"}]], "\[Prime]"], 
                    RowBox[{"-", 
                    SubsuperscriptBox["m", 
                    SubscriptBox["jh", 
                    RowBox[{"1", "\[InvisibleComma]", "2"}]], "\[Prime]"]}]}
                  }], "|", GridBox[{
                   {"j"},
                   {"0"}
                  }], ")"}],
                SpanMaxSize->DirectedInfinity[1]]}]}]}]}]}]}]}]}]}]}]}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.60621186771808*^9, 3.606211963214326*^9, 3.606212210638855*^9, {
   3.606212670332807*^9, 3.6062126765024767`*^9}, 3.6062129579360847`*^9, 
   3.606213120307226*^9, 3.6062133542973423`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"declareQNInteger", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"jh", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"mjh", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"jp", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"mjp", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"jpp", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"mjpp", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"jhp", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"mjhp", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", "j", ",", "0"}], "}"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"declareQNHalfInteger", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"jp", "[", "1", "]"}], ",", 
     RowBox[{"mjp", "[", "1", "]"}], ",", 
     RowBox[{"jp", "[", "2", "]"}], ",", 
     RowBox[{"mjp", "[", "2", "]"}], ",", 
     RowBox[{"jh", "[", "1", "]"}], ",", 
     RowBox[{"mjh", "[", "1", "]"}], ",", 
     RowBox[{"jh", "[", "2", "]"}], ",", 
     RowBox[{"mjh", "[", "2", "]"}], ",", 
     RowBox[{"jpp", "[", "1", "]"}], ",", 
     RowBox[{"mjpp", "[", "1", "]"}], ",", 
     RowBox[{"jpp", "[", "2", "]"}], ",", 
     RowBox[{"mjpp", "[", "2", "]"}], ",", 
     RowBox[{"jhp", "[", "1", "]"}], ",", 
     RowBox[{"mjhp", "[", "1", "]"}], ",", 
     RowBox[{"jhp", "[", "2", "]"}], ",", 
     RowBox[{"mjhp", "[", "2", "]"}]}], "}"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6062120385229*^9, 3.6062121596125193`*^9}, {
  3.606212227854082*^9, 3.606212228862948*^9}, {3.6062133646107693`*^9, 
  3.6062133733342457`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"testExpr", "[", "2", "]"}], "//", "consistencyCheck"}]], "Input",
 CellChangeTimes->{{3.6062121954843893`*^9, 3.606212201150676*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"result", "[", "2", "]"}], "=", 
   RowBox[{"simplifyAMSum", "[", 
    RowBox[{
     RowBox[{"testExpr", "[", "2", "]"}], ",", 
     RowBox[{"Print", "\[Rule]", "True"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6062122380795183`*^9, 3.606212265720067*^9}, 
   3.606212306601363*^9}],

Cell[BoxData[
 TagBox[
  FormBox[
   RowBox[{
    UnderscriptBox["\[Sum]", 
     SubscriptBox["m", 
      SubscriptBox["jh", "1"]]], 
    RowBox[{
     UnderscriptBox["\[Sum]", 
      SubscriptBox["m", 
       SubscriptBox["jh", "2"]]], 
     RowBox[{
      UnderscriptBox["\[Sum]", 
       SubscriptBox["m", 
        SubscriptBox["jh", 
         RowBox[{"1", "\[InvisibleComma]", "2"}]]]], 
      RowBox[{
       UnderscriptBox["\[Sum]", 
        SubsuperscriptBox["m", 
         SubscriptBox["jh", "2"], "\[Prime]"]], 
       RowBox[{
        UnderscriptBox["\[Sum]", 
         SubscriptBox["m", 
          SubscriptBox["jp", "2"]]], 
        RowBox[{
         UnderscriptBox["\[Sum]", 
          SubsuperscriptBox["m", 
           SubscriptBox["jp", "1"], "\[Prime]"]], 
         RowBox[{
          UnderscriptBox["\[Sum]", 
           SubsuperscriptBox["m", 
            SubscriptBox["jp", "2"], "\[Prime]"]], 
          RowBox[{
           UnderscriptBox["\[Sum]", 
            SubsuperscriptBox["m", 
             SubscriptBox["jp", 
              RowBox[{"1", "\[InvisibleComma]", "2"}]], "\[Prime]"]], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "j"}], "+", "1"}], ")"}], " ", 
            SqrtBox[
             RowBox[{
              RowBox[{"2", " ", 
               SubscriptBox["jh", 
                RowBox[{"1", "\[InvisibleComma]", "2"}]]}], "+", "1"}]], " ", 
            
            SqrtBox[
             RowBox[{
              RowBox[{"2", " ", 
               SubscriptBox["jp", 
                RowBox[{"1", "\[InvisibleComma]", "2"}]]}], "+", "1"}]], " ", 
            
            SqrtBox[
             RowBox[{
              RowBox[{"2", " ", 
               SubsuperscriptBox["jh", 
                RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"]}], "+", 
              "1"}]], " ", 
            SqrtBox[
             RowBox[{
              RowBox[{"2", " ", 
               SubsuperscriptBox["jp", 
                RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"]}], "+", 
              "1"}]], " ", 
            TemplateBox[{RowBox[{
                SubscriptBox["jh", "1"], ",", 
                SubsuperscriptBox["jh", "1", "\[Prime]"]}]},
             "KroneckerDeltaSeq"], " ", 
            TemplateBox[{RowBox[{
                SubscriptBox["jp", "1"], ",", 
                SubsuperscriptBox["jp", "1", "\[Prime]"]}]},
             "KroneckerDeltaSeq"], " ", 
            RowBox[{
             TagBox[
              StyleBox["(",
               SpanMaxSize->DirectedInfinity[1]],
              ThreeJSymbol], "\[MediumSpace]", GridBox[{
               {
                SubscriptBox["jh", "1"], 
                SubscriptBox["jh", "2"], 
                SubscriptBox["jh", 
                 RowBox[{"1", "\[InvisibleComma]", "2"}]]},
               {
                SubscriptBox["m", 
                 SubscriptBox["jh", "1"]], 
                SubscriptBox["m", 
                 SubscriptBox["jh", "2"]], 
                RowBox[{"-", 
                 SubscriptBox["m", 
                  SubscriptBox["jh", 
                   RowBox[{"1", "\[InvisibleComma]", "2"}]]]}]}
              }], "\[MediumSpace]", 
             TagBox[
              StyleBox[")",
               SpanMaxSize->DirectedInfinity[1]],
              ThreeJSymbol]}], " ", 
            RowBox[{
             TagBox[
              StyleBox["(",
               SpanMaxSize->DirectedInfinity[1]],
              ThreeJSymbol], "\[MediumSpace]", GridBox[{
               {
                SubsuperscriptBox["jp", "1", "\[Prime]"], 
                SubsuperscriptBox["jp", "2", "\[Prime]"], 
                SubsuperscriptBox["jp", 
                 RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"]},
               {
                SubsuperscriptBox["m", 
                 SubscriptBox["jp", "1"], "\[Prime]"], 
                SubsuperscriptBox["m", 
                 SubscriptBox["jp", "2"], "\[Prime]"], 
                RowBox[{"-", 
                 SubsuperscriptBox["m", 
                  SubscriptBox["jp", 
                   RowBox[{"1", "\[InvisibleComma]", "2"}]], "\[Prime]"]}]}
              }], "\[MediumSpace]", 
             TagBox[
              StyleBox[")",
               SpanMaxSize->DirectedInfinity[1]],
              ThreeJSymbol]}], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"3", " ", 
                SubscriptBox["m", 
                 SubscriptBox["jh", 
                  RowBox[{"1", "\[InvisibleComma]", "2"}]]]}]}], "+", 
              RowBox[{"2", " ", 
               SubsuperscriptBox["jh", 
                RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"]}], "+", 
              SubsuperscriptBox["jh", "2", "\[Prime]"], "+", 
              RowBox[{"2", " ", 
               SubscriptBox["jh", 
                RowBox[{"1", "\[InvisibleComma]", "2"}]]}], "-", 
              RowBox[{"2", " ", 
               SubscriptBox["jh", "1"]}], "+", 
              SubscriptBox["jh", "2"], "-", 
              RowBox[{"3", " ", 
               SubsuperscriptBox["m", 
                SubscriptBox["jp", 
                 RowBox[{"1", "\[InvisibleComma]", "2"}]], "\[Prime]"]}], "-", 
              SubsuperscriptBox["jp", 
               RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"], "-", 
              RowBox[{"2", " ", 
               SubsuperscriptBox["jp", "1", "\[Prime]"]}], "+", 
              SubsuperscriptBox["jp", "2", "\[Prime]"], "-", 
              SubscriptBox["jp", 
               RowBox[{"1", "\[InvisibleComma]", "2"}]], "+", 
              SubscriptBox["jp", "2"]}]], " ", 
            RowBox[{
             TagBox[
              StyleBox["(",
               SpanMaxSize->DirectedInfinity[1]],
              ThreeJSymbol], "\[MediumSpace]", GridBox[{
               {
                SubscriptBox["jp", 
                 RowBox[{"1", "\[InvisibleComma]", "2"}]], 
                SubscriptBox["jh", 
                 RowBox[{"1", "\[InvisibleComma]", "2"}]], "j"},
               {
                SubscriptBox["m", 
                 SubscriptBox["jh", 
                  RowBox[{"1", "\[InvisibleComma]", "2"}]]], 
                RowBox[{"-", 
                 SubscriptBox["m", 
                  SubscriptBox["jh", 
                   RowBox[{"1", "\[InvisibleComma]", "2"}]]]}], "0"}
              }], "\[MediumSpace]", 
             TagBox[
              StyleBox[")",
               SpanMaxSize->DirectedInfinity[1]],
              ThreeJSymbol]}], " ", 
            RowBox[{
             TagBox[
              StyleBox["(",
               SpanMaxSize->DirectedInfinity[1]],
              ThreeJSymbol], "\[MediumSpace]", GridBox[{
               {
                SubscriptBox["jh", "1"], 
                SubsuperscriptBox["jh", "2", "\[Prime]"], 
                SubsuperscriptBox["jh", 
                 RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"]},
               {
                SubscriptBox["m", 
                 SubscriptBox["jh", "1"]], 
                SubsuperscriptBox["m", 
                 SubscriptBox["jh", "2"], "\[Prime]"], 
                RowBox[{"-", 
                 SubsuperscriptBox["m", 
                  SubscriptBox["jp", 
                   RowBox[{"1", "\[InvisibleComma]", "2"}]], "\[Prime]"]}]}
              }], "\[MediumSpace]", 
             TagBox[
              StyleBox[")",
               SpanMaxSize->DirectedInfinity[1]],
              ThreeJSymbol]}], " ", 
            RowBox[{
             TagBox[
              StyleBox["(",
               SpanMaxSize->DirectedInfinity[1]],
              ThreeJSymbol], "\[MediumSpace]", GridBox[{
               {
                SubsuperscriptBox["jp", "1", "\[Prime]"], 
                SubscriptBox["jp", "2"], 
                SubscriptBox["jp", 
                 RowBox[{"1", "\[InvisibleComma]", "2"}]]},
               {
                SubsuperscriptBox["m", 
                 SubscriptBox["jp", "1"], "\[Prime]"], 
                SubscriptBox["m", 
                 SubscriptBox["jp", "2"]], 
                RowBox[{"-", 
                 SubscriptBox["m", 
                  SubscriptBox["jh", 
                   RowBox[{"1", "\[InvisibleComma]", "2"}]]]}]}
              }], "\[MediumSpace]", 
             TagBox[
              StyleBox[")",
               SpanMaxSize->DirectedInfinity[1]],
              ThreeJSymbol]}], " ", 
            RowBox[{
             TagBox[
              StyleBox["(",
               SpanMaxSize->DirectedInfinity[1]],
              ThreeJSymbol], "\[MediumSpace]", GridBox[{
               {
                SubsuperscriptBox["jp", 
                 RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"], 
                SubsuperscriptBox["jh", 
                 RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"], "j"},
               {
                SubsuperscriptBox["m", 
                 SubscriptBox["jp", 
                  RowBox[{"1", "\[InvisibleComma]", "2"}]], "\[Prime]"], 
                RowBox[{"-", 
                 SubsuperscriptBox["m", 
                  SubscriptBox["jp", 
                   RowBox[{"1", "\[InvisibleComma]", "2"}]], "\[Prime]"]}], 
                "0"}
              }], "\[MediumSpace]", 
             TagBox[
              StyleBox[")",
               SpanMaxSize->DirectedInfinity[1]],
              ThreeJSymbol]}]}]}]}]}]}]}]}]}]}],
   TraditionalForm],
  TraditionalForm,
  Editable->True]], "Print",
 CellChangeTimes->{3.606212267530748*^9, 3.60621230723419*^9, 
  3.6062126840194407`*^9, 3.606212962237238*^9, 3.6062131244675922`*^9, 
  3.606213377375978*^9}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.606213529698329*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testExpr", "[", "3", "]"}], "=", 
   RowBox[{"sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"cg", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jp", "[", "1", "]"}], ",", 
          RowBox[{"mjp", "[", "1", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jp", "[", "2", "]"}], ",", 
          RowBox[{"mjp", "[", "2", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jp", "[", 
           RowBox[{"1", ",", "2"}], "]"}], ",", 
          RowBox[{"mjp", "[", 
           RowBox[{"1", ",", "2"}], "]"}]}], "}"}]}], "]"}], 
      RowBox[{"cg", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jh", "[", "1", "]"}], ",", 
          RowBox[{"mjh", "[", "1", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jh", "[", "2", "]"}], ",", 
          RowBox[{"mjh", "[", "2", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jh", "[", 
           RowBox[{"1", ",", "2"}], "]"}], ",", 
          RowBox[{"mjh", "[", 
           RowBox[{"1", ",", "2"}], "]"}]}], "}"}]}], "]"}], 
      RowBox[{"cg", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jp", "[", 
           RowBox[{"1", ",", "2"}], "]"}], ",", 
          RowBox[{"mjp", "[", 
           RowBox[{"1", ",", "2"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jh", "[", 
           RowBox[{"1", ",", "2"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"mjh", "[", 
            RowBox[{"1", ",", "2"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
      RowBox[{"cg", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jpp", "[", "1", "]"}], ",", 
          RowBox[{"mjpp", "[", "1", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jpp", "[", "2", "]"}], ",", 
          RowBox[{"mjpp", "[", "2", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jpp", "[", 
           RowBox[{"1", ",", "2"}], "]"}], ",", 
          RowBox[{"mjpp", "[", 
           RowBox[{"1", ",", "2"}], "]"}]}], "}"}]}], "]"}], 
      RowBox[{"cg", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jhp", "[", "1", "]"}], ",", 
          RowBox[{"mjhp", "[", "1", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jhp", "[", "2", "]"}], ",", 
          RowBox[{"mjhp", "[", "2", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jhp", "[", 
           RowBox[{"1", ",", "2"}], "]"}], ",", 
          RowBox[{"mjhp", "[", 
           RowBox[{"1", ",", "2"}], "]"}]}], "}"}]}], "]"}], 
      RowBox[{"cg", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jpp", "[", 
           RowBox[{"1", ",", "2"}], "]"}], ",", 
          RowBox[{"mjpp", "[", 
           RowBox[{"1", ",", "2"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jhp", "[", 
           RowBox[{"1", ",", "2"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"mjhp", "[", 
            RowBox[{"1", ",", "2"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0"}], "}"}]}], "]"}], 
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{
        RowBox[{"jh", "[", "1", "]"}], ",", 
        RowBox[{"jhp", "[", "1", "]"}]}], "]"}], 
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{
        RowBox[{"mjh", "[", "1", "]"}], ",", 
        RowBox[{"mjhp", "[", "1", "]"}]}], "]"}], "\[IndentingNewLine]", 
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{
        RowBox[{"jp", "[", "1", "]"}], ",", 
        RowBox[{"jpp", "[", "1", "]"}]}], "]"}], 
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{
        RowBox[{"mjp", "[", "1", "]"}], ",", 
        RowBox[{"mjpp", "[", "1", "]"}]}], "]"}], "\[IndentingNewLine]", 
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{
        RowBox[{"jh", "[", "2", "]"}], ",", 
        RowBox[{"jhp", "[", "2", "]"}]}], "]"}], 
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{
        RowBox[{"mjh", "[", "2", "]"}], ",", 
        RowBox[{"mjhp", "[", "2", "]"}]}], "]"}], "\[IndentingNewLine]", 
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{
        RowBox[{"jp", "[", "2", "]"}], ",", 
        RowBox[{"jpp", "[", "2", "]"}]}], "]"}], 
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{
        RowBox[{"mjp", "[", "2", "]"}], ",", 
        RowBox[{"mjpp", "[", "2", "]"}]}], "]"}], "\[IndentingNewLine]", 
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{
        RowBox[{"mjh", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"mjp", "[", 
         RowBox[{"1", ",", "2"}], "]"}]}], "]"}], 
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{
        RowBox[{"mjhp", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"mjpp", "[", 
         RowBox[{"1", ",", "2"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
     ",", 
     RowBox[{"mjp", "[", "1", "]"}], ",", 
     RowBox[{"mjp", "[", "2", "]"}], ",", 
     RowBox[{"mjh", "[", "1", "]"}], ",", 
     RowBox[{"mjh", "[", "2", "]"}], ",", 
     RowBox[{"mjpp", "[", "1", "]"}], ",", 
     RowBox[{"mjpp", "[", "2", "]"}], ",", 
     RowBox[{"mjhp", "[", "1", "]"}], ",", 
     RowBox[{"mjhp", "[", "2", "]"}], ",", 
     RowBox[{"mjp", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"mjh", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"mjpp", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"mjhp", "[", 
      RowBox[{"1", ",", "2"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"declareIndexedAM", "[", 
   RowBox[{"{", 
    RowBox[{"jp", ",", "jh"}], "}"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.606213540094226*^9, 3.606213561615053*^9}, {
  3.6062135919406137`*^9, 3.606213593651005*^9}, {3.606213650127226*^9, 
  3.606213653498126*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"result", "[", "3", "]"}], "=", 
   RowBox[{"simplifyAMSum", "[", 
    RowBox[{
     RowBox[{"testExpr", "[", "3", "]"}], ",", 
     RowBox[{"Print", "\[Rule]", "True"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.606213574890197*^9, 3.606213576971262*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  FormBox[
   RowBox[{
    UnderscriptBox["\[Sum]", 
     SubscriptBox["m", 
      SubscriptBox["jh", "1"]]], 
    RowBox[{
     UnderscriptBox["\[Sum]", 
      SubscriptBox["m", 
       SubscriptBox["jh", "2"]]], 
     RowBox[{
      UnderscriptBox["\[Sum]", 
       SubscriptBox["m", 
        SubscriptBox["jh", 
         RowBox[{"1", "\[InvisibleComma]", "2"}]]]], 
      RowBox[{
       UnderscriptBox["\[Sum]", 
        SubsuperscriptBox["m", 
         SubscriptBox["jp", "1"], "\[Prime]"]], 
       RowBox[{
        UnderscriptBox["\[Sum]", 
         SubsuperscriptBox["m", 
          SubscriptBox["jp", "2"], "\[Prime]"]], 
        RowBox[{
         UnderscriptBox["\[Sum]", 
          SubsuperscriptBox["m", 
           SubscriptBox["jp", 
            RowBox[{"1", "\[InvisibleComma]", "2"}]], "\[Prime]"]], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "j"}], "+", "1"}], ")"}], " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"2", " ", 
             SubscriptBox["jh", 
              RowBox[{"1", "\[InvisibleComma]", "2"}]]}], "+", "1"}]], " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"2", " ", 
             SubscriptBox["jp", 
              RowBox[{"1", "\[InvisibleComma]", "2"}]]}], "+", "1"}]], " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"2", " ", 
             SubsuperscriptBox["jh", 
              RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"]}], "+", 
            "1"}]], " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"2", " ", 
             SubsuperscriptBox["jp", 
              RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"]}], "+", 
            "1"}]], " ", 
          TemplateBox[{RowBox[{
              SubscriptBox["jh", "1"], ",", 
              SubsuperscriptBox["jh", "1", "\[Prime]"]}]},
           "KroneckerDeltaSeq"], " ", 
          TemplateBox[{RowBox[{
              SubscriptBox["jh", "2"], ",", 
              SubsuperscriptBox["jh", "2", "\[Prime]"]}]},
           "KroneckerDeltaSeq"], " ", 
          TemplateBox[{RowBox[{
              SubscriptBox["jp", "1"], ",", 
              SubsuperscriptBox["jp", "1", "\[Prime]"]}]},
           "KroneckerDeltaSeq"], " ", 
          TemplateBox[{RowBox[{
              SubscriptBox["jp", "2"], ",", 
              SubsuperscriptBox["jp", "2", "\[Prime]"]}]},
           "KroneckerDeltaSeq"], " ", 
          RowBox[{
           TagBox[
            StyleBox["(",
             SpanMaxSize->DirectedInfinity[1]],
            ThreeJSymbol], "\[MediumSpace]", GridBox[{
             {
              SubscriptBox["jh", "1"], 
              SubscriptBox["jh", "2"], 
              SubscriptBox["jh", 
               RowBox[{"1", "\[InvisibleComma]", "2"}]]},
             {
              SubscriptBox["m", 
               SubscriptBox["jh", "1"]], 
              SubscriptBox["m", 
               SubscriptBox["jh", "2"]], 
              RowBox[{"-", 
               SubscriptBox["m", 
                SubscriptBox["jh", 
                 RowBox[{"1", "\[InvisibleComma]", "2"}]]]}]}
            }], "\[MediumSpace]", 
           TagBox[
            StyleBox[")",
             SpanMaxSize->DirectedInfinity[1]],
            ThreeJSymbol]}], " ", 
          RowBox[{
           TagBox[
            StyleBox["(",
             SpanMaxSize->DirectedInfinity[1]],
            ThreeJSymbol], "\[MediumSpace]", GridBox[{
             {
              SubsuperscriptBox["jp", "1", "\[Prime]"], 
              SubsuperscriptBox["jp", "2", "\[Prime]"], 
              SubsuperscriptBox["jp", 
               RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"]},
             {
              SubsuperscriptBox["m", 
               SubscriptBox["jp", "1"], "\[Prime]"], 
              SubsuperscriptBox["m", 
               SubscriptBox["jp", "2"], "\[Prime]"], 
              RowBox[{"-", 
               SubsuperscriptBox["m", 
                SubscriptBox["jp", 
                 RowBox[{"1", "\[InvisibleComma]", "2"}]], "\[Prime]"]}]}
            }], "\[MediumSpace]", 
           TagBox[
            StyleBox[")",
             SpanMaxSize->DirectedInfinity[1]],
            ThreeJSymbol]}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"2", " ", 
              SubscriptBox["m", 
               SubscriptBox["jh", 
                RowBox[{"1", "\[InvisibleComma]", "2"}]]]}]}], "+", 
            SubsuperscriptBox["jh", 
             RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"], "+", 
            SubscriptBox["jh", 
             RowBox[{"1", "\[InvisibleComma]", "2"}]], "-", 
            RowBox[{"2", " ", 
             SubscriptBox["jh", "1"]}], "+", 
            RowBox[{"2", " ", 
             SubscriptBox["jh", "2"]}], "-", 
            RowBox[{"2", " ", 
             SubsuperscriptBox["m", 
              SubscriptBox["jp", 
               RowBox[{"1", "\[InvisibleComma]", "2"}]], "\[Prime]"]}], "-", 
            SubsuperscriptBox["jp", 
             RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"], "-", 
            RowBox[{"2", " ", 
             SubsuperscriptBox["jp", "1", "\[Prime]"]}], "+", 
            RowBox[{"2", " ", 
             SubsuperscriptBox["jp", "2", "\[Prime]"]}], "-", 
            SubscriptBox["jp", 
             RowBox[{"1", "\[InvisibleComma]", "2"}]]}]], " ", 
          RowBox[{
           TagBox[
            StyleBox["(",
             SpanMaxSize->DirectedInfinity[1]],
            ThreeJSymbol], "\[MediumSpace]", GridBox[{
             {
              SubscriptBox["jp", 
               RowBox[{"1", "\[InvisibleComma]", "2"}]], 
              SubscriptBox["jh", 
               RowBox[{"1", "\[InvisibleComma]", "2"}]], "j"},
             {
              SubscriptBox["m", 
               SubscriptBox["jh", 
                RowBox[{"1", "\[InvisibleComma]", "2"}]]], 
              RowBox[{"-", 
               SubscriptBox["m", 
                SubscriptBox["jh", 
                 RowBox[{"1", "\[InvisibleComma]", "2"}]]]}], "0"}
            }], "\[MediumSpace]", 
           TagBox[
            StyleBox[")",
             SpanMaxSize->DirectedInfinity[1]],
            ThreeJSymbol]}], " ", 
          RowBox[{
           TagBox[
            StyleBox["(",
             SpanMaxSize->DirectedInfinity[1]],
            ThreeJSymbol], "\[MediumSpace]", GridBox[{
             {
              SubscriptBox["jh", "1"], 
              SubscriptBox["jh", "2"], 
              SubsuperscriptBox["jh", 
               RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"]},
             {
              SubscriptBox["m", 
               SubscriptBox["jh", "1"]], 
              SubscriptBox["m", 
               SubscriptBox["jh", "2"]], 
              RowBox[{"-", 
               SubsuperscriptBox["m", 
                SubscriptBox["jp", 
                 RowBox[{"1", "\[InvisibleComma]", "2"}]], "\[Prime]"]}]}
            }], "\[MediumSpace]", 
           TagBox[
            StyleBox[")",
             SpanMaxSize->DirectedInfinity[1]],
            ThreeJSymbol]}], " ", 
          RowBox[{
           TagBox[
            StyleBox["(",
             SpanMaxSize->DirectedInfinity[1]],
            ThreeJSymbol], "\[MediumSpace]", GridBox[{
             {
              SubsuperscriptBox["jp", "1", "\[Prime]"], 
              SubsuperscriptBox["jp", "2", "\[Prime]"], 
              SubscriptBox["jp", 
               RowBox[{"1", "\[InvisibleComma]", "2"}]]},
             {
              SubsuperscriptBox["m", 
               SubscriptBox["jp", "1"], "\[Prime]"], 
              SubsuperscriptBox["m", 
               SubscriptBox["jp", "2"], "\[Prime]"], 
              RowBox[{"-", 
               SubscriptBox["m", 
                SubscriptBox["jh", 
                 RowBox[{"1", "\[InvisibleComma]", "2"}]]]}]}
            }], "\[MediumSpace]", 
           TagBox[
            StyleBox[")",
             SpanMaxSize->DirectedInfinity[1]],
            ThreeJSymbol]}], " ", 
          RowBox[{
           TagBox[
            StyleBox["(",
             SpanMaxSize->DirectedInfinity[1]],
            ThreeJSymbol], "\[MediumSpace]", GridBox[{
             {
              SubsuperscriptBox["jp", 
               RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"], 
              SubsuperscriptBox["jh", 
               RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"], "j"},
             {
              SubsuperscriptBox["m", 
               SubscriptBox["jp", 
                RowBox[{"1", "\[InvisibleComma]", "2"}]], "\[Prime]"], 
              RowBox[{"-", 
               SubsuperscriptBox["m", 
                SubscriptBox["jp", 
                 RowBox[{"1", "\[InvisibleComma]", "2"}]], "\[Prime]"]}], 
              "0"}
            }], "\[MediumSpace]", 
           TagBox[
            StyleBox[")",
             SpanMaxSize->DirectedInfinity[1]],
            ThreeJSymbol]}]}]}]}]}]}]}]}],
   TraditionalForm],
  TraditionalForm,
  Editable->True]], "Print",
 CellChangeTimes->{{3.606213577499316*^9, 3.6062135953407173`*^9}, 
   3.606213656017267*^9}],

Cell[BoxData[
 TagBox[
  FormBox[
   RowBox[{
    UnderscriptBox["\[Sum]", 
     SubscriptBox["m", 
      SubscriptBox["jh", 
       RowBox[{"1", "\[InvisibleComma]", "2"}]]]], 
    RowBox[{
     UnderscriptBox["\[Sum]", 
      SubsuperscriptBox["m", 
       SubscriptBox["jp", "1"], "\[Prime]"]], 
     RowBox[{
      UnderscriptBox["\[Sum]", 
       SubsuperscriptBox["m", 
        SubscriptBox["jp", "2"], "\[Prime]"]], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "j"}], "+", "1"}], ")"}], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"2", " ", 
          SubscriptBox["jp", 
           RowBox[{"1", "\[InvisibleComma]", "2"}]]}], "+", "1"}]], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"2", " ", 
          SubsuperscriptBox["jp", 
           RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"]}], "+", 
         "1"}]], " ", 
       TemplateBox[{RowBox[{
           SubscriptBox["jh", "1"], ",", 
           SubsuperscriptBox["jh", "1", "\[Prime]"]}]},
        "KroneckerDeltaSeq"], " ", 
       TemplateBox[{RowBox[{
           SubscriptBox["jh", "2"], ",", 
           SubsuperscriptBox["jh", "2", "\[Prime]"]}]},
        "KroneckerDeltaSeq"], " ", 
       TemplateBox[{RowBox[{
           SubscriptBox["jp", "1"], ",", 
           SubsuperscriptBox["jp", "1", "\[Prime]"]}]},
        "KroneckerDeltaSeq"], " ", 
       TemplateBox[{RowBox[{
           SubscriptBox["jp", "2"], ",", 
           SubsuperscriptBox["jp", "2", "\[Prime]"]}]},
        "KroneckerDeltaSeq"], " ", 
       StyleBox[
        RowBox[{"\[EmptyUpTriangle]", "{", 
         SubscriptBox["jh", "1"], 
         SubscriptBox["jh", "2"], 
         SubscriptBox["jh", 
          RowBox[{"1", "\[InvisibleComma]", "2"}]], "}"}],
        SpanMaxSize->DirectedInfinity[1]], " ", 
       TemplateBox[{RowBox[{
           SubscriptBox["jh", 
            RowBox[{"1", "\[InvisibleComma]", "2"}]], ",", 
           SubsuperscriptBox["jh", 
            RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"]}]},
        "KroneckerDeltaSeq"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{
         SubscriptBox["m", 
          SubscriptBox["jh", 
           RowBox[{"1", "\[InvisibleComma]", "2"}]]], "+", 
         SubsuperscriptBox["m", 
          SubscriptBox["jp", "1"], "\[Prime]"], "+", 
         SubsuperscriptBox["m", 
          SubscriptBox["jp", "2"], "\[Prime]"], "+", 
         SubsuperscriptBox["jp", "1", "\[Prime]"], "+", 
         SubsuperscriptBox["jp", "2", "\[Prime]"], "+", 
         SubscriptBox["jp", 
          RowBox[{"1", "\[InvisibleComma]", "2"}]]}]], " ", 
       RowBox[{
        TagBox[
         StyleBox["(",
          SpanMaxSize->DirectedInfinity[1]],
         ThreeJSymbol], "\[MediumSpace]", GridBox[{
          {
           SubscriptBox["jp", 
            RowBox[{"1", "\[InvisibleComma]", "2"}]], 
           SubscriptBox["jh", 
            RowBox[{"1", "\[InvisibleComma]", "2"}]], "j"},
          {
           SubscriptBox["m", 
            SubscriptBox["jh", 
             RowBox[{"1", "\[InvisibleComma]", "2"}]]], 
           RowBox[{"-", 
            SubscriptBox["m", 
             SubscriptBox["jh", 
              RowBox[{"1", "\[InvisibleComma]", "2"}]]]}], "0"}
         }], "\[MediumSpace]", 
        TagBox[
         StyleBox[")",
          SpanMaxSize->DirectedInfinity[1]],
         ThreeJSymbol]}], " ", 
       RowBox[{
        TagBox[
         StyleBox["(",
          SpanMaxSize->DirectedInfinity[1]],
         ThreeJSymbol], "\[MediumSpace]", GridBox[{
          {
           SubsuperscriptBox["jp", "1", "\[Prime]"], 
           SubsuperscriptBox["jp", "2", "\[Prime]"], 
           SubsuperscriptBox["jp", 
            RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"]},
          {
           RowBox[{"-", 
            SubsuperscriptBox["m", 
             SubscriptBox["jp", "1"], "\[Prime]"]}], 
           RowBox[{"-", 
            SubsuperscriptBox["m", 
             SubscriptBox["jp", "2"], "\[Prime]"]}], 
           SubscriptBox["m", 
            SubscriptBox["jh", 
             RowBox[{"1", "\[InvisibleComma]", "2"}]]]}
         }], "\[MediumSpace]", 
        TagBox[
         StyleBox[")",
          SpanMaxSize->DirectedInfinity[1]],
         ThreeJSymbol]}], " ", 
       RowBox[{
        TagBox[
         StyleBox["(",
          SpanMaxSize->DirectedInfinity[1]],
         ThreeJSymbol], "\[MediumSpace]", GridBox[{
          {
           SubsuperscriptBox["jp", "1", "\[Prime]"], 
           SubsuperscriptBox["jp", "2", "\[Prime]"], 
           SubscriptBox["jp", 
            RowBox[{"1", "\[InvisibleComma]", "2"}]]},
          {
           SubsuperscriptBox["m", 
            SubscriptBox["jp", "1"], "\[Prime]"], 
           SubsuperscriptBox["m", 
            SubscriptBox["jp", "2"], "\[Prime]"], 
           RowBox[{"-", 
            SubscriptBox["m", 
             SubscriptBox["jh", 
              RowBox[{"1", "\[InvisibleComma]", "2"}]]]}]}
         }], "\[MediumSpace]", 
        TagBox[
         StyleBox[")",
          SpanMaxSize->DirectedInfinity[1]],
         ThreeJSymbol]}], " ", 
       RowBox[{
        TagBox[
         StyleBox["(",
          SpanMaxSize->DirectedInfinity[1]],
         ThreeJSymbol], "\[MediumSpace]", GridBox[{
          {
           SubsuperscriptBox["jp", 
            RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"], 
           SubscriptBox["jh", 
            RowBox[{"1", "\[InvisibleComma]", "2"}]], "j"},
          {
           SubscriptBox["m", 
            SubscriptBox["jh", 
             RowBox[{"1", "\[InvisibleComma]", "2"}]]], 
           RowBox[{"-", 
            SubscriptBox["m", 
             SubscriptBox["jh", 
              RowBox[{"1", "\[InvisibleComma]", "2"}]]]}], "0"}
         }], "\[MediumSpace]", 
        TagBox[
         StyleBox[")",
          SpanMaxSize->DirectedInfinity[1]],
         ThreeJSymbol]}]}]}]}]}],
   TraditionalForm],
  TraditionalForm,
  Editable->True]], "Print",
 CellChangeTimes->{{3.606213577499316*^9, 3.6062135953407173`*^9}, 
   3.6062136563010263`*^9}],

Cell[BoxData[
 TagBox[
  FormBox[
   RowBox[{
    UnderscriptBox["\[Sum]", 
     SubscriptBox["m", 
      SubscriptBox["jh", 
       RowBox[{"1", "\[InvisibleComma]", "2"}]]]], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "j"}], "+", "1"}], ")"}], " ", 
     TemplateBox[{RowBox[{
         SubscriptBox["jh", "1"], ",", 
         SubsuperscriptBox["jh", "1", "\[Prime]"]}]},
      "KroneckerDeltaSeq"], " ", 
     TemplateBox[{RowBox[{
         SubscriptBox["jh", "2"], ",", 
         SubsuperscriptBox["jh", "2", "\[Prime]"]}]},
      "KroneckerDeltaSeq"], " ", 
     TemplateBox[{RowBox[{
         SubscriptBox["jp", "1"], ",", 
         SubsuperscriptBox["jp", "1", "\[Prime]"]}]},
      "KroneckerDeltaSeq"], " ", 
     TemplateBox[{RowBox[{
         SubscriptBox["jp", "2"], ",", 
         SubsuperscriptBox["jp", "2", "\[Prime]"]}]},
      "KroneckerDeltaSeq"], " ", 
     StyleBox[
      RowBox[{"\[EmptyUpTriangle]", "{", 
       SubscriptBox["jh", "1"], 
       SubscriptBox["jh", "2"], 
       SubscriptBox["jh", 
        RowBox[{"1", "\[InvisibleComma]", "2"}]], "}"}],
      SpanMaxSize->DirectedInfinity[1]], " ", 
     TemplateBox[{RowBox[{
         SubscriptBox["jh", 
          RowBox[{"1", "\[InvisibleComma]", "2"}]], ",", 
         SubsuperscriptBox["jh", 
          RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"]}]},
      "KroneckerDeltaSeq"], " ", 
     TemplateBox[{RowBox[{
         SubscriptBox["jp", 
          RowBox[{"1", "\[InvisibleComma]", "2"}]], ",", 
         SubsuperscriptBox["jp", 
          RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"]}]},
      "KroneckerDeltaSeq"], " ", 
     StyleBox[
      RowBox[{"\[EmptyUpTriangle]", "{", 
       SubsuperscriptBox["jp", "1", "\[Prime]"], 
       SubsuperscriptBox["jp", "2", "\[Prime]"], 
       SubsuperscriptBox["jp", 
        RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"], "}"}],
      SpanMaxSize->DirectedInfinity[1]], " ", 
     SuperscriptBox[
      RowBox[{
       TagBox[
        StyleBox["(",
         SpanMaxSize->DirectedInfinity[1]],
        ThreeJSymbol], "\[MediumSpace]", GridBox[{
         {
          SubsuperscriptBox["jp", 
           RowBox[{"1", "\[InvisibleComma]", "2"}], "\[Prime]"], 
          SubscriptBox["jh", 
           RowBox[{"1", "\[InvisibleComma]", "2"}]], "j"},
         {
          SubscriptBox["m", 
           SubscriptBox["jh", 
            RowBox[{"1", "\[InvisibleComma]", "2"}]]], 
          RowBox[{"-", 
           SubscriptBox["m", 
            SubscriptBox["jh", 
             RowBox[{"1", "\[InvisibleComma]", "2"}]]]}], "0"}
        }], "\[MediumSpace]", 
       TagBox[
        StyleBox[")",
         SpanMaxSize->DirectedInfinity[1]],
        ThreeJSymbol]}], "2"]}]}],
   TraditionalForm],
  TraditionalForm,
  Editable->True]], "Print",
 CellChangeTimes->{{3.606213577499316*^9, 3.6062135953407173`*^9}, 
   3.6062136563999434`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Misc", "Section",
 CellChangeTimes->{{3.6255583119369793`*^9, 3.625558312272605*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"declareQNInteger", "@", 
   RowBox[{"{", 
    RowBox[{
    "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f", ",", "g", ",", "h",
      ",", "x", ",", "q", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]", 
     ",", "\[Delta]", ",", "\[Epsilon]", ",", "\[Phi]", ",", "\[Kappa]", ",", 
     "\[Xi]"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.625554340538823*^9, 3.625554434368792*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"i", "=", "0"}], ";", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"expr", "[", "i", "]"}], "=", 
     RowBox[{"sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "x"}], "+", "1"}], ")"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"x", "-", "\[Xi]"}], ")"}]}], 
        RowBox[{"tj", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"d", ",", "\[Delta]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"b", ",", "\[Beta]"}], "}"}]}], "]"}], 
        RowBox[{"tj", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", "\[Alpha]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", "\[Gamma]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"-", "\[Xi]"}]}], "}"}]}], "]"}], 
        RowBox[{"sj", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"b", ",", "d", ",", "x"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", "a", ",", "q"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"set", "[", 
        RowBox[{"x", ",", "\[Xi]"}], "]"}]}], "]"}]}], ")"}], "//", 
   "TraditionalForm"}]}]], "Input",
 CellChangeTimes->{{3.625554432970023*^9, 3.625554537187481*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   UnderscriptBox["\[Sum]", "x"], 
   RowBox[{
    UnderscriptBox["\[Sum]", "\[Xi]"], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "x"}], "+", "1"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      RowBox[{"x", "-", "\[Xi]"}]], " ", 
     RowBox[{
      TagBox[
       StyleBox["(",
        SpanMaxSize->DirectedInfinity[1]],
       ThreeJSymbol], "\[MediumSpace]", GridBox[{
        {"a", "c", "x"},
        {"\[Alpha]", "\[Gamma]", 
         RowBox[{"-", "\[Xi]"}]}
       }], "\[MediumSpace]", 
      TagBox[
       StyleBox[")",
        SpanMaxSize->DirectedInfinity[1]],
       ThreeJSymbol]}], " ", 
     RowBox[{
      TagBox[
       StyleBox["(",
        SpanMaxSize->DirectedInfinity[1]],
       ThreeJSymbol], "\[MediumSpace]", GridBox[{
        {"x", "d", "b"},
        {"\[Xi]", "\[Delta]", "\[Beta]"}
       }], "\[MediumSpace]", 
      TagBox[
       StyleBox[")",
        SpanMaxSize->DirectedInfinity[1]],
       ThreeJSymbol]}], " ", 
     RowBox[{
      TagBox[
       StyleBox["{",
        SpanMaxSize->DirectedInfinity[1]],
       SixJSymbol], "\[MediumSpace]", GridBox[{
        {"b", "d", "x"},
        {"c", "a", "q"}
       }], "\[MediumSpace]", 
      TagBox[
       StyleBox["}",
        SpanMaxSize->DirectedInfinity[1]],
       SixJSymbol]}]}]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.625554539168745*^9, 3.625555135300457*^9, 
  3.625555256282077*^9, 3.625555383794386*^9, 3.625555528388199*^9, 
  3.62555821542737*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ";", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"expr", "[", "i", "]"}], "=", 
      RowBox[{"simplifyAMSum", "[", 
       RowBox[{
        RowBox[{"expr", "[", 
         RowBox[{"i", "-", "1"}], "]"}], ",", 
        RowBox[{"Print", "\[Rule]", "True"}], ",", 
        RowBox[{"OnlySums", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"x", ",", "\[Xi]"}], "}"}]}]}], "]"}]}], ")"}], "//", 
    "TraditionalForm"}]}]}]], "Input",
 CellChangeTimes->{{3.625554583813428*^9, 3.625554605636736*^9}, {
  3.625555122886077*^9, 3.625555151953395*^9}, {3.625555271314686*^9, 
  3.625555271794396*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox[
    FormBox[
     RowBox[{
      UnderscriptBox["\[Sum]", "x"], 
      RowBox[{
       UnderscriptBox["\[Sum]", "\[Xi]"], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "x"}], "+", "1"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"\[Xi]", "+", "x"}]], " ", 
        RowBox[{
         TagBox[
          StyleBox["(",
           SpanMaxSize->DirectedInfinity[1]],
          ThreeJSymbol], "\[MediumSpace]", GridBox[{
           {"a", "c", "x"},
           {"\[Alpha]", "\[Gamma]", 
            RowBox[{"-", "\[Xi]"}]}
          }], "\[MediumSpace]", 
         TagBox[
          StyleBox[")",
           SpanMaxSize->DirectedInfinity[1]],
          ThreeJSymbol]}], " ", 
        RowBox[{
         TagBox[
          StyleBox["(",
           SpanMaxSize->DirectedInfinity[1]],
          ThreeJSymbol], "\[MediumSpace]", GridBox[{
           {"x", "d", "b"},
           {"\[Xi]", "\[Delta]", "\[Beta]"}
          }], "\[MediumSpace]", 
         TagBox[
          StyleBox[")",
           SpanMaxSize->DirectedInfinity[1]],
          ThreeJSymbol]}], " ", 
        RowBox[{
         TagBox[
          StyleBox["{",
           SpanMaxSize->DirectedInfinity[1]],
          SixJSymbol], "\[MediumSpace]", GridBox[{
           {"a", "b", "q"},
           {"d", "c", "x"}
          }], "\[MediumSpace]", 
         TagBox[
          StyleBox["}",
           SpanMaxSize->DirectedInfinity[1]],
          SixJSymbol]}]}]}]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], "\[InvisibleSpace]", "\<\"working on:\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    FormBox[
     RowBox[{
      UnderscriptBox["\[Sum]", "x"], 
      RowBox[{
       UnderscriptBox["\[Sum]", "\[Xi]"], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "x"}], "+", "1"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"\[Xi]", "+", "x"}]], " ", 
        RowBox[{
         TagBox[
          StyleBox["(",
           SpanMaxSize->DirectedInfinity[1]],
          ThreeJSymbol], "\[MediumSpace]", GridBox[{
           {"a", "c", "x"},
           {"\[Alpha]", "\[Gamma]", 
            RowBox[{"-", "\[Xi]"}]}
          }], "\[MediumSpace]", 
         TagBox[
          StyleBox[")",
           SpanMaxSize->DirectedInfinity[1]],
          ThreeJSymbol]}], " ", 
        RowBox[{
         TagBox[
          StyleBox["(",
           SpanMaxSize->DirectedInfinity[1]],
          ThreeJSymbol], "\[MediumSpace]", GridBox[{
           {"x", "d", "b"},
           {"\[Xi]", "\[Delta]", "\[Beta]"}
          }], "\[MediumSpace]", 
         TagBox[
          StyleBox[")",
           SpanMaxSize->DirectedInfinity[1]],
          ThreeJSymbol]}], " ", 
        RowBox[{
         TagBox[
          StyleBox["{",
           SpanMaxSize->DirectedInfinity[1]],
          SixJSymbol], "\[MediumSpace]", GridBox[{
           {"a", "b", "q"},
           {"d", "c", "x"}
          }], "\[MediumSpace]", 
         TagBox[
          StyleBox["}",
           SpanMaxSize->DirectedInfinity[1]],
          SixJSymbol]}]}]}]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True]}],
  SequenceForm[
   TraditionalForm[
    Utility`sum[(-1)^($CellContext`x + $CellContext`\[Xi]) (1 + 
      2 $CellContext`x) 
     AngularMomentum`sj[{$CellContext`a, $CellContext`b, $CellContext`q}, \
{$CellContext`d, $CellContext`c, $CellContext`x}] 
     AngularMomentum`tj[{$CellContext`a, $CellContext`\[Alpha]}, \
{$CellContext`c, $CellContext`\[Gamma]}, {$CellContext`x, \
-$CellContext`\[Xi]}] 
     AngularMomentum`tj[{$CellContext`x, $CellContext`\[Xi]}, \
{$CellContext`d, $CellContext`\[Delta]}, {$CellContext`b, \
$CellContext`\[Beta]}], 
     Utility`set[$CellContext`x, $CellContext`\[Xi]]]], "working on:", 
   TraditionalForm[
    Utility`sum[(-1)^($CellContext`x + $CellContext`\[Xi]) (1 + 
      2 $CellContext`x) 
     AngularMomentum`sj[{$CellContext`a, $CellContext`b, $CellContext`q}, \
{$CellContext`d, $CellContext`c, $CellContext`x}] 
     AngularMomentum`tj[{$CellContext`a, $CellContext`\[Alpha]}, \
{$CellContext`c, $CellContext`\[Gamma]}, {$CellContext`x, \
-$CellContext`\[Xi]}] 
     AngularMomentum`tj[{$CellContext`x, $CellContext`\[Xi]}, \
{$CellContext`d, $CellContext`\[Delta]}, {$CellContext`b, \
$CellContext`\[Beta]}], 
     Utility`set[$CellContext`x, $CellContext`\[Xi]]]]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.625554607610519*^9, {3.625555132016621*^9, 3.6255551531337423`*^9}, 
   3.625555257491952*^9, 3.625555384884199*^9, 3.625555529420553*^9, 
   3.6255582177849483`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox[
    FormBox[
     RowBox[{
      UnderscriptBox["\[Sum]", 
       SubscriptBox["K", "1"]], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{
         SubscriptBox["K", "1"], "+", "q"}]], " ", 
       RowBox[{
        TagBox[
         StyleBox["(",
          SpanMaxSize->DirectedInfinity[1]],
         ThreeJSymbol], "\[MediumSpace]", GridBox[{
          {"q", "a", "b"},
          {
           SubscriptBox["K", "1"], "\[Alpha]", "\[Beta]"}
         }], "\[MediumSpace]", 
        TagBox[
         StyleBox[")",
          SpanMaxSize->DirectedInfinity[1]],
         ThreeJSymbol]}], " ", 
       RowBox[{
        TagBox[
         StyleBox["(",
          SpanMaxSize->DirectedInfinity[1]],
         ThreeJSymbol], "\[MediumSpace]", GridBox[{
          {"d", "c", "q"},
          {"\[Delta]", "\[Gamma]", 
           RowBox[{"-", 
            SubscriptBox["K", "1"]}]}
         }], "\[MediumSpace]", 
        TagBox[
         StyleBox[")",
          SpanMaxSize->DirectedInfinity[1]],
         ThreeJSymbol]}]}]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], "\[InvisibleSpace]", "\<\"working on:\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    FormBox["1",
     TraditionalForm],
    TraditionalForm,
    Editable->True]}],
  SequenceForm[
   TraditionalForm[
    Utility`sum[(-1)^($CellContext`q + $CellContext`varK[1]) 
     AngularMomentum`tj[{$CellContext`d, $CellContext`\[Delta]}, \
{$CellContext`c, $CellContext`\[Gamma]}, {$CellContext`q, -$CellContext`varK[
         1]}] AngularMomentum`tj[{$CellContext`q, 
        $CellContext`varK[
        1]}, {$CellContext`a, $CellContext`\[Alpha]}, {$CellContext`b, \
$CellContext`\[Beta]}], 
     Utility`set[
      $CellContext`varK[1]]]], "working on:", 
   TraditionalForm[1]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.625554607610519*^9, {3.625555132016621*^9, 3.6255551531337423`*^9}, 
   3.625555257491952*^9, 3.625555384884199*^9, 3.625555529420553*^9, 
   3.625558217801478*^9}]
}, Open  ]],

Cell[BoxData[
 FormBox[
  RowBox[{
   UnderscriptBox["\[Sum]", 
    SubscriptBox["K", "1"]], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], 
     RowBox[{
      SubscriptBox["K", "1"], "+", "q"}]], " ", 
    RowBox[{
     TagBox[
      StyleBox["(",
       SpanMaxSize->DirectedInfinity[1]],
      ThreeJSymbol], "\[MediumSpace]", GridBox[{
       {"q", "a", "b"},
       {
        SubscriptBox["K", "1"], "\[Alpha]", "\[Beta]"}
      }], "\[MediumSpace]", 
     TagBox[
      StyleBox[")",
       SpanMaxSize->DirectedInfinity[1]],
      ThreeJSymbol]}], " ", 
    RowBox[{
     TagBox[
      StyleBox["(",
       SpanMaxSize->DirectedInfinity[1]],
      ThreeJSymbol], "\[MediumSpace]", GridBox[{
       {"d", "c", "q"},
       {"\[Delta]", "\[Gamma]", 
        RowBox[{"-", 
         SubscriptBox["K", "1"]}]}
      }], "\[MediumSpace]", 
     TagBox[
      StyleBox[")",
       SpanMaxSize->DirectedInfinity[1]],
      ThreeJSymbol]}]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.625554607654805*^9, {3.625555132220661*^9, 3.625555153187496*^9}, 
   3.625555257553834*^9, 3.625555384951455*^9, 3.625555529490385*^9, 
   3.6255582178332357`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Additional Remarks", "Section",
 CellChangeTimes->{{3.606123416647088*^9, 3.606123443510784*^9}}],

Cell["\<\
It is possible to extract all the conditions from your expression. This is \
used internally but might be helpful to do explicitely, for instance when \
implementing a formula:\
\>", "Text",
 CellChangeTimes->{{3.60612345587886*^9, 3.606123519702414*^9}, {
  3.606125592536127*^9, 3.606125593992619*^9}}],

Cell["All conditions before simplifying the expression:", "Text",
 CellChangeTimes->{{3.6061235426784563`*^9, 3.6061235514791307`*^9}, 
   3.606123951143304*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"testExpr", "[", "1", "]"}], "//", "extractConditions"}], "//", 
  "TraditionalForm"}]], "Input",
 CellChangeTimes->{{3.606123521252499*^9, 3.606123535805262*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    StyleBox[
     RowBox[{"\[EmptyUpTriangle]", "{", 
      FractionBox["1", "2"], 
      FractionBox["1", "2"], 
      SubscriptBox["t", 
       RowBox[{"a", "\[InvisibleComma]", "b"}]], "}"}],
     SpanMaxSize->DirectedInfinity[1]], ",", 
    TemplateBox[{RowBox[{
        RowBox[{
          SubscriptBox["m", 
           SubscriptBox["t", "a"]], "+", 
          SubscriptBox["m", 
           SubscriptBox["t", "b"]], "-", 
          SubscriptBox["m", 
           SubscriptBox["t", 
            RowBox[{"a", "\[InvisibleComma]", "b"}]]]}], ",", "0"}]},
     "KroneckerDeltaSeq"], ",", 
    StyleBox[
     RowBox[{"\[EmptyUpTriangle]", "{", 
      FractionBox["1", "2"], 
      FractionBox["1", "2"], 
      SubsuperscriptBox["t", 
       RowBox[{"a", "\[InvisibleComma]", "b"}], "\[Prime]"], "}"}],
     SpanMaxSize->DirectedInfinity[1]], ",", 
    TemplateBox[{RowBox[{
        RowBox[{
          SubsuperscriptBox["m", 
           SubscriptBox["t", "a"], "\[Prime]"], "+", 
          SubsuperscriptBox["m", 
           SubscriptBox["t", "b"], "\[Prime]"], "-", 
          SubsuperscriptBox["m", 
           SubscriptBox["t", 
            RowBox[{"a", "\[InvisibleComma]", "b"}]], "\[Prime]"]}], ",", 
        "0"}]},
     "KroneckerDeltaSeq"], ",", 
    StyleBox[
     RowBox[{"\[EmptyUpTriangle]", "{", 
      FractionBox["1", "2"], 
      SubscriptBox["t", 
       RowBox[{"a", "\[InvisibleComma]", "b"}]], 
      SubscriptBox["t", 
       RowBox[{"a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}]], 
      "}"}],
     SpanMaxSize->DirectedInfinity[1]], ",", 
    TemplateBox[{RowBox[{
        RowBox[{
          SubscriptBox["m", 
           SubscriptBox["t", "c"]], "+", 
          SubscriptBox["m", 
           SubscriptBox["t", 
            RowBox[{"a", "\[InvisibleComma]", "b"}]]], "-", 
          SubscriptBox["m", 
           SubscriptBox["t", 
            
            RowBox[{"a", "\[InvisibleComma]", "b", "\[InvisibleComma]", 
              "c"}]]]}], ",", "0"}]},
     "KroneckerDeltaSeq"], ",", 
    StyleBox[
     RowBox[{"\[EmptyUpTriangle]", "{", 
      FractionBox["1", "2"], 
      SubsuperscriptBox["t", 
       RowBox[{"a", "\[InvisibleComma]", "b"}], "\[Prime]"], 
      SubsuperscriptBox["t", 
       RowBox[{"a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}], 
       "\[Prime]"], "}"}],
     SpanMaxSize->DirectedInfinity[1]], ",", 
    TemplateBox[{RowBox[{
        RowBox[{
          SubsuperscriptBox["m", 
           SubscriptBox["t", "c"], "\[Prime]"], "+", 
          SubsuperscriptBox["m", 
           SubscriptBox["t", 
            RowBox[{"a", "\[InvisibleComma]", "b"}]], "\[Prime]"], "-", 
          SubsuperscriptBox["m", 
           SubscriptBox["t", 
            
            RowBox[{"a", "\[InvisibleComma]", "b", "\[InvisibleComma]", 
              "c"}]], "\[Prime]"]}], ",", "0"}]},
     "KroneckerDeltaSeq"], ",", 
    StyleBox[
     RowBox[{"\[EmptyUpTriangle]", "{", 
      FractionBox["1", "2"], 
      FractionBox["1", "2"], "1", "}"}],
     SpanMaxSize->DirectedInfinity[1]], ",", 
    TemplateBox[{RowBox[{
        RowBox[{"\[Mu]", "+", 
          SubscriptBox["m", 
           SubscriptBox["t", "b"]], "-", 
          SubsuperscriptBox["m", 
           SubscriptBox["t", "b"], "\[Prime]"]}], ",", "0"}]},
     "KroneckerDeltaSeq"], ",", 
    TemplateBox[{RowBox[{
        RowBox[{"\[Mu]", "-", 
          SubscriptBox["m", 
           SubscriptBox["t", "a"]], "+", 
          SubsuperscriptBox["m", 
           SubscriptBox["t", "a"], "\[Prime]"]}], ",", "0"}]},
     "KroneckerDeltaSeq"]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.606123995964735*^9, 3.6061254336409397`*^9, 
  3.606125516769183*^9}]
}, Open  ]],

Cell["\<\
After simplifying all conditions involving sums that have been evaluated do \
not exist anymore:\
\>", "Text",
 CellChangeTimes->{{3.6061235426784563`*^9, 3.6061235514791307`*^9}, {
  3.606123951143304*^9, 3.606123994583098*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"result", "//", "extractConditions"}], "//", 
  "TraditionalForm"}]], "Input",
 CellChangeTimes->{{3.606123521252499*^9, 3.606123535805262*^9}, {
  3.606123999146945*^9, 3.606123999801433*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    StyleBox[
     RowBox[{"\[EmptyUpTriangle]", "{", 
      FractionBox["1", "2"], 
      SubscriptBox["t", 
       RowBox[{"a", "\[InvisibleComma]", "b"}]], 
      SubscriptBox["t", 
       RowBox[{"a", "\[InvisibleComma]", "b", "\[InvisibleComma]", "c"}]], 
      "}"}],
     SpanMaxSize->DirectedInfinity[1]], ",", 
    StyleBox[
     RowBox[{"\[EmptyUpTriangle]", "{", 
      FractionBox["1", "2"], 
      FractionBox["1", "2"], "1", "}"}],
     SpanMaxSize->DirectedInfinity[1]], ",", 
    StyleBox[
     RowBox[{"\[EmptyUpTriangle]", "{", 
      FractionBox["1", "2"], 
      FractionBox["1", "2"], 
      SubscriptBox["t", 
       RowBox[{"a", "\[InvisibleComma]", "b"}]], "}"}],
     SpanMaxSize->DirectedInfinity[1]]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.6061240004545317`*^9, 3.6061254356386757`*^9, 
  3.606125518566761*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Behind the Scenes", "Section",
 CellChangeTimes->{{3.60612684215379*^9, 3.606126852984652*^9}}],

Cell["\<\
This section aims at explaining the algorithm that makes the simplification \
process possible.
If you just want to use the simplification it is not necessary to read it.\
\>", "Text",
 CellChangeTimes->{{3.606126859977127*^9, 3.6061269230015287`*^9}}],

Cell["\<\
For accessing the internal functions we add the AngularMomentum`Private` \
context:\
\>", "Text",
 CellChangeTimes->{{3.6062083523506203`*^9, 3.60620835727844*^9}, {
  3.606210308369211*^9, 3.60621033201711*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$ContextPath", "=", 
  RowBox[{"DeleteDuplicates", "@", 
   RowBox[{"Append", "[", 
    RowBox[{"$ContextPath", ",", "\"\<AngularMomentum`Private`\>\""}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.606208309723764*^9, 3.606208340545787*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"AngularMomentum`\"\>", ",", "\<\"Utility`\"\>", 
   ",", "\<\"PacletManager`\"\>", ",", "\<\"QuantityUnits`\"\>", 
   ",", "\<\"WebServices`\"\>", ",", "\<\"System`\"\>", 
   ",", "\<\"Global`\"\>", ",", "\<\"AngularMomentum`Private`\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.606210334009708*^9, 3.606216073304543*^9}]
}, Open  ]],

Cell["\<\
In general terms, the algorithm can be describes in the following way:

One can enter replacement rules, as they are found in Varshalovich or similar \
collections. However, these replacement rules usually do not match an \
expression, as 3j, 6j and 9j symbols can be rotated and transformed in \
different ways changing factors of the expression by doing so. Therefore the \
simplification algorithm transforms the input expression and the replacement \
rules in such a way that all possible matches are found, then applies the \
transformed replacement rules to the transformed expression and transforms \
the result back to a more traditional / readable form.\
\>", "Text",
 CellChangeTimes->{{3.606210370673461*^9, 3.606210585729432*^9}, {
  3.6062106204974318`*^9, 3.6062106569619513`*^9}, {3.606210766291171*^9, 
  3.606210770931465*^9}}],

Cell["\<\
In the following sections these transformations are discussed\
\>", "Text",
 CellChangeTimes->{{3.606210785345639*^9, 3.606210806610094*^9}}],

Cell[CellGroupData[{

Cell["(-1)^(...) Factors", "Subsection",
 CellChangeTimes->{{3.606210892738276*^9, 3.606210901873765*^9}}],

Cell["\<\
To simplify the factors these are transformed to the following representation:\
\>", "Text",
 CellChangeTimes->{{3.606210910258424*^9, 3.606210913074173*^9}, {
   3.606215955322722*^9, 3.606215978794128*^9}, {3.606216064106791*^9, 
   3.606216086202914*^9}, 3.606216123579133*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"-", "1"}], ")"}], "^", 
   RowBox[{"(", 
    RowBox[{"fac1", "+", 
     RowBox[{"2", "fac2"}], "+", 
     RowBox[{"3", "fac3"}], "-", "fac4"}], ")"}]}], "//.", 
  "simplifyFactorRules"}]], "Input",
 CellChangeTimes->{{3.6062160878672953`*^9, 3.6062161270480003`*^9}, {
  3.6062161663770733`*^9, 3.60621616724024*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"mX", "[", "fac1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"mX", "[", "fac2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"mX", "[", "fac3", "]"}], "3"]}], 
  RowBox[{"mX", "[", "fac4", "]"}]]], "Output",
 CellChangeTimes->{{3.6062161205752287`*^9, 3.606216127657323*^9}, 
   3.606216167880628*^9}]
}, Open  ]],

Cell["\<\
If we tell declare these factors to be integer or half-integer quantum \
numbers, the simplification will be more effective:\
\>", "Text",
 CellChangeTimes->{{3.6062161321552477`*^9, 3.6062161737722807`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"declareQNInteger", "[", 
   RowBox[{"{", 
    RowBox[{"fac2", ",", "fac4"}], "}"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"declareQNHalfInteger", "[", 
   RowBox[{"{", "fac3", "}"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.60621617611125*^9, 3.606216205825111*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"-", "1"}], ")"}], "^", 
   RowBox[{"(", 
    RowBox[{"fac1", "+", 
     RowBox[{"2", "fac2"}], "+", 
     RowBox[{"3", "fac3"}], "-", "fac4"}], ")"}]}], "//.", 
  "simplifyFactorRules"}]], "Input",
 CellChangeTimes->{{3.606216208588477*^9, 3.606216208589305*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"mX", "[", "fac1", "]"}]}], " ", 
  RowBox[{"mX", "[", "fac3", "]"}], " ", 
  RowBox[{"mX", "[", "fac4", "]"}]}]], "Output",
 CellChangeTimes->{3.6062162110491657`*^9}]
}, Open  ]],

Cell["\<\
This rule is applied to expressions and replacement rules. As one does not \
know wether some symbol is an integer or half-integer in a replacement rule, \
it is important to enter the replacement rule with positive factors without \
any numbers in front of it, e.g.\
\>", "Text",
 CellChangeTimes->{{3.606216243772127*^9, 3.606216332154696*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"-", "1"}], ")"}], "^", 
   RowBox[{"(", 
    RowBox[{"a_", "+", "b_", "+", "c_"}], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6062163447980127`*^9, 3.606216353502384*^9}, 
   3.606216403822413*^9}],

Cell["\<\
is ok, while the following expressions should not be entered to a replacement \
rule:\
\>", "Text",
 CellChangeTimes->{{3.6062163336584873`*^9, 3.606216373066506*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"-", "1"}], ")"}], "^", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", "a_"}], " ", "+", "b_"}], ")"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"-", "1"}], ")"}], "^", 
   RowBox[{"(", 
    RowBox[{"-", "c_"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"-", "1"}], ")"}], "^", 
   RowBox[{"(", 
    RowBox[{"a_", "+", "a_"}], ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.606216374769547*^9, 3.606216414542644*^9}}],

Cell["\<\
Factors in replacement rules will automatically be moved to the right-hand \
side, if they are independent of the summation variables. This is done using \
\[OpenCurlyDoubleQuote]normalizeSumRule\[CloseCurlyDoubleQuote]:\
\>", "Text",
 CellChangeTimes->{{3.6062164172585087`*^9, 3.606216475979117*^9}, 
   3.606216634332305*^9, {3.615889589548843*^9, 3.6158895918688383`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"normalizeSumRule", "[", 
  RowBox[{
   RowBox[{"sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"mX", "[", "sa_", "]"}], 
      RowBox[{"mX", "[", "sb_", "]"}], 
      RowBox[{"mX", "[", "sc_", "]"}], 
      RowBox[{"sj", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"sa_", ",", "sb_", ",", "sc_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"sd_", ",", "se_", ",", "sf_"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"set", "[", 
      RowBox[{"sb_", ",", "sc_", ",", "se_", ",", "sf_", ",", "su___"}], 
      "]"}]}], "]"}], "\[RuleDelayed]", " ", 
   RowBox[{"sum", "[", 
    RowBox[{"42", ",", 
     RowBox[{"set", "[", "su", "]"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.606216477423751*^9, 3.606216628948866*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"mX", "[", "sb_", "]"}], " ", 
     RowBox[{"mX", "[", "sc_", "]"}], " ", 
     RowBox[{"sj", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sa_", ",", "sb_", ",", "sc_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"sd_", ",", "se_", ",", "sf_"}], "}"}]}], "]"}]}], ",", 
    RowBox[{"set", "[", 
     RowBox[{"sb_", ",", "sc_", ",", "se_", ",", "sf_", ",", "su___"}], 
     "]"}]}], "]"}], "\[RuleDelayed]", 
  RowBox[{"sum", "[", 
   RowBox[{
    FractionBox["42", 
     RowBox[{"mX", "[", "sa", "]"}]], ",", 
    RowBox[{"set", "[", "su", "]"}]}], "]"}]}]], "Output",
 CellChangeTimes->{3.6062165882698593`*^9, 3.606216629537057*^9}]
}, Open  ]],

Cell["", "Text"],

Cell["", "Text"],

Cell["", "Text"],

Cell["", "Text"],

Cell["", "Text"],

Cell["", "Text"],

Cell["", "Text"],

Cell["", "Text"],

Cell["", "Text"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{758, 867},
WindowMargins->{{Automatic, 223}, {65, Automatic}},
ShowSelection->True,
FrontEndVersion->"10.0 for Linux x86 (64-bit) (June 27, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 96, 1, 65, "Section"],
Cell[678, 25, 138, 1, 33, "Text"],
Cell[819, 28, 398, 10, 55, "Input"],
Cell[1220, 40, 355, 6, 77, "Text"],
Cell[1578, 48, 212, 4, 55, "Text"],
Cell[1793, 54, 4030, 117, 209, "Input"],
Cell[5826, 173, 226, 5, 33, "Text"],
Cell[CellGroupData[{
Cell[6077, 182, 164, 3, 32, "Input"],
Cell[6244, 187, 4729, 136, 234, "Output"]
}, Open  ]],
Cell[10988, 326, 315, 7, 77, "Text"],
Cell[11306, 335, 153, 3, 32, "Input"],
Cell[11462, 340, 190, 4, 55, "Text"],
Cell[CellGroupData[{
Cell[11677, 348, 125, 2, 32, "Input"],
Cell[11805, 352, 1600, 47, 78, "Print"]
}, Open  ]],
Cell[13420, 402, 107, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[13552, 407, 165, 3, 32, "Input"],
Cell[13720, 412, 6099, 170, 189, "Output"]
}, Open  ]],
Cell[19834, 585, 458, 8, 77, "Text"],
Cell[CellGroupData[{
Cell[20317, 597, 166, 3, 32, "Input"],
Cell[20486, 602, 661, 12, 59, "Message"],
Cell[21150, 616, 649, 12, 59, "Message"],
Cell[21802, 630, 647, 12, 59, "Message"],
Cell[22452, 644, 578, 11, 41, "Message"],
Cell[23033, 657, 564, 11, 70, "Message"],
Cell[23600, 670, 860, 15, 49, "Message"],
Cell[24463, 687, 578, 12, 70, "Message"],
Cell[25044, 701, 579, 11, 41, "Message"],
Cell[25626, 714, 609, 12, 90, "Message"],
Cell[26238, 728, 611, 12, 90, "Message"],
Cell[26852, 742, 657, 12, 63, "Message"],
Cell[27512, 756, 578, 11, 41, "Message"]
}, Open  ]],
Cell[28105, 770, 647, 13, 121, "Text"],
Cell[28755, 785, 1170, 32, 77, "Input"],
Cell[29928, 819, 158, 2, 33, "Text"],
Cell[CellGroupData[{
Cell[30111, 825, 163, 3, 32, "Input"],
Cell[30277, 830, 789, 14, 51, "Message"],
Cell[31069, 846, 764, 14, 50, "Message"],
Cell[31836, 862, 588, 10, 59, "Message"]
}, Open  ]],
Cell[32439, 875, 531, 9, 99, "Text"],
Cell[CellGroupData[{
Cell[32995, 888, 138, 2, 32, "Input"],
Cell[33136, 892, 346, 7, 41, "Message"],
Cell[33485, 901, 122, 2, 32, "Output"]
}, Open  ]],
Cell[33622, 906, 324, 6, 55, "Text"],
Cell[CellGroupData[{
Cell[33971, 916, 208, 4, 32, "Input"],
Cell[34182, 922, 175, 3, 32, "Output"]
}, Open  ]],
Cell[34372, 928, 217, 4, 33, "Text"],
Cell[34592, 934, 100, 2, 32, "Input"],
Cell[34695, 938, 575, 11, 121, "Text"],
Cell[CellGroupData[{
Cell[35295, 953, 389, 9, 32, "Input"],
Cell[CellGroupData[{
Cell[35709, 966, 8944, 240, 237, "Print"],
Cell[44656, 1208, 7427, 210, 190, "Print"],
Cell[52086, 1420, 4206, 127, 129, "Print"],
Cell[56295, 1549, 2169, 65, 67, "Print"]
}, Open  ]],
Cell[58479, 1617, 1498, 46, 133, "Output"]
}, Open  ]],
Cell[59992, 1666, 156, 3, 33, "Text"],
Cell[CellGroupData[{
Cell[60173, 1673, 267, 5, 32, "Input"],
Cell[60443, 1680, 2059, 61, 74, "Output"]
}, Open  ]],
Cell[62517, 1744, 1014, 15, 231, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63568, 1764, 156, 2, 65, "Section"],
Cell[63727, 1768, 6446, 179, 363, "Input"],
Cell[CellGroupData[{
Cell[70198, 1951, 169, 3, 32, "Input"],
Cell[70370, 1956, 9522, 232, 256, "Output"]
}, Open  ]],
Cell[79907, 2191, 1678, 44, 121, "Input"],
Cell[81588, 2237, 168, 3, 32, "Input"],
Cell[CellGroupData[{
Cell[81781, 2244, 338, 9, 32, "Input"],
Cell[82122, 2255, 9729, 252, 231, "Print"],
Cell[91854, 2509, 77, 1, 32, "Output"]
}, Open  ]],
Cell[91946, 2513, 6165, 172, 363, "Input"],
Cell[CellGroupData[{
Cell[98136, 2689, 310, 8, 32, "Input"],
Cell[CellGroupData[{
Cell[98471, 2701, 9190, 247, 198, "Print"],
Cell[107664, 2950, 6119, 174, 151, "Print"],
Cell[113786, 3126, 2915, 82, 96, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[116762, 3215, 91, 1, 65, "Section"],
Cell[116856, 3218, 432, 9, 32, "Input"],
Cell[CellGroupData[{
Cell[117313, 3231, 1466, 44, 99, "Input"],
Cell[118782, 3277, 1572, 53, 75, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[120391, 3335, 701, 19, 99, "Input"],
Cell[CellGroupData[{
Cell[121117, 3358, 4752, 141, 95, "Print"],
Cell[125872, 3501, 2091, 66, 49, "Print"]
}, Open  ]],
Cell[127978, 3570, 1199, 41, 75, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[129226, 3617, 103, 1, 65, "Section"],
Cell[129332, 3620, 314, 6, 55, "Text"],
Cell[129649, 3628, 161, 2, 33, "Text"],
Cell[CellGroupData[{
Cell[129835, 3634, 209, 5, 32, "Input"],
Cell[130047, 3641, 3743, 103, 157, "Output"]
}, Open  ]],
Cell[133805, 3747, 239, 5, 55, "Text"],
Cell[CellGroupData[{
Cell[134069, 3756, 227, 5, 32, "Input"],
Cell[134299, 3763, 910, 26, 57, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[135258, 3795, 101, 1, 65, "Section"],
Cell[135362, 3798, 262, 5, 55, "Text"],
Cell[135627, 3805, 222, 5, 33, "Text"],
Cell[CellGroupData[{
Cell[135874, 3814, 270, 6, 55, "Input"],
Cell[136147, 3822, 370, 7, 55, "Output"]
}, Open  ]],
Cell[136532, 3832, 854, 14, 209, "Text"],
Cell[137389, 3848, 151, 3, 33, "Text"],
Cell[CellGroupData[{
Cell[137565, 3855, 106, 1, 45, "Subsection"],
Cell[137674, 3858, 290, 5, 33, "Text"],
Cell[CellGroupData[{
Cell[137989, 3867, 382, 11, 32, "Input"],
Cell[138374, 3880, 358, 10, 55, "Output"]
}, Open  ]],
Cell[138747, 3893, 218, 4, 55, "Text"],
Cell[138968, 3899, 328, 8, 55, "Input"],
Cell[CellGroupData[{
Cell[139321, 3911, 328, 10, 32, "Input"],
Cell[139652, 3923, 219, 6, 32, "Output"]
}, Open  ]],
Cell[139886, 3932, 356, 6, 77, "Text"],
Cell[140245, 3940, 267, 8, 32, "Input"],
Cell[140515, 3950, 177, 4, 33, "Text"],
Cell[140695, 3956, 584, 21, 77, "Input"],
Cell[141282, 3979, 386, 6, 55, "Text"],
Cell[CellGroupData[{
Cell[141693, 3989, 779, 21, 77, "Input"],
Cell[142475, 4012, 741, 21, 75, "Output"]
}, Open  ]],
Cell[143231, 4036, 16, 0, 33, "Text"],
Cell[143250, 4038, 16, 0, 33, "Text"],
Cell[143269, 4040, 16, 0, 33, "Text"],
Cell[143288, 4042, 16, 0, 33, "Text"],
Cell[143307, 4044, 16, 0, 33, "Text"],
Cell[143326, 4046, 16, 0, 33, "Text"],
Cell[143345, 4048, 16, 0, 33, "Text"],
Cell[143364, 4050, 16, 0, 33, "Text"],
Cell[143383, 4052, 16, 0, 33, "Text"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
